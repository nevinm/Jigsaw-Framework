

    window || (this.window = this);
    window.CodeEffects || (window.CodeEffects = { typeName: "CodeEffects", getName: function() { return "CodeEffects"; }, __namespace: !0 });
    CodeEffects.register || (CodeEffects.register = function(a) {
        var d = window;
        a = a.split(".");
        for (var e = 0; e < a.length; e++) {
            var j = a[e], h = d[j];
            h || (h = d[j] = { typeName: a.slice(0, e + 1).join("."), __namespace: !0 }, h.getName = function() { return this.typeName; });
            d = h;
        }
    });
    CodeEffects.register("CodeEffects.Rule.Client");
    CodeEffects.register("CodeEffects.Rule.Models");
    CodeEffects.register("CodeEffects.Rule.Menu");
    CodeEffects.register("CodeEffects.Rule.Calendar");
    CodeEffects.register("CodeEffects.Rule.Time");
    CodeEffects.register("CodeEffects.Rule.TextBox");
    var $rule = CodeEffects.Rule;
    $rule.Client.type = { IE: 0, Chrome: 1, Firefox: 2, Opera: 3, Other: 4 };
    $rule.Client.browser = null;
    $rule.Client.version = 0;
    navigator.appName && -1 < navigator.appName.toLowerCase().indexOf("explorer") || -1 < navigator.userAgent.indexOf(" MSIE ") ? ($rule.Client.browser = $rule.Client.type.IE, $rule.Client.version = parseFloat(navigator.userAgent.match(/MSIE (\d+\.\d+)/)[1])) : $rule.Client.browser = -1 < navigator.userAgent.toLowerCase().indexOf(" firefox/") ? $rule.Client.type.Firefox : -1 < navigator.userAgent.toLowerCase().indexOf(" applewebkit/") ? $rule.Client.type.Chrome : navigator.appName && -1 < navigator.appName.toLowerCase().indexOf("opera") ||
        -1 < navigator.userAgent.toLowerCase().indexOf("opera/") ? $rule.Client.type.Opera : $rule.Client.type.Other;
    $rule.defined = function(a) { return null != a && "undefined" != typeof a && "NaN" != String(a); };
    $rule.text = function(a, d) {
        if (!a.tagName) return null;
        if ($rule.defined(d)) $rule.defined(document.getElementsByTagName("BODY")[0].innerText) ? a.innerText = d.toString() : a.textContent = d.toString();
        else return $rule.defined(document.getElementsByTagName("BODY")[0].innerText) ? a.innerText : a.textContent;
    };
    $rule.trim = function(a) { return !$rule.defined(a) || 0 === a.length ? a : a.replace(/^\s+|\s+$/g, ""); };
    $rule.highlight = function(a) { a.style.backgroundColor = "#ffff91"; };
    $rule.dim = function(a) { a.style.backgroundColor = ""; };
    $rule.getScrollBarWidth = function() {
        var a = document.createElement("DIV");
        a.style.width = "100%";
        a.style.height = "200px";
        var d = document.createElement("DIV");
        d.style.position = "absolute";
        d.style.top = d.style.left = "0px";
        d.style.width = "200px";
        d.style.height = "150px";
        $rule.Client.browser == $rule.Client.type.IE ? d.style.visibility = d.style.overflow = "" : d.style.overflow = "hidden";
        d.appendChild(a);
        document.body.appendChild(d);
        var e = a.offsetWidth;
        d.style.overflow = $rule.Client.browser == $rule.Client.type.IE ? "scroll" : "auto";
        a = a.offsetWidth;
        $rule.Client.browser == $rule.Client.type.IE && e == a && (a = d.clientWidth);
        document.body.removeChild(d);
        return e - a;
    };
    $rule.getElementWidth = function(a) { return a.offsetWidth && 0 < a.offsetWidth ? a.offsetWidth : a.style.pixelWidth && 0 < a.style.pixelWidth ? a.style.pixelWidth : a.style.posWidth && 0 < a.style.posWidth ? a.style.posWidth : a.style.width && 0 < a.style.width.length ? parseInt(a.style.width.substr(0, a.style.width.length - 2)) : 0; };
    $rule.getElementHeight = function(a) { return $rule.defined(a.offsetHeight) && 0 < a.offsetHeight ? a.offsetHeight : $rule.defined(a.style.pixelHeight) && 0 < a.style.pixelHeight ? a.style.pixelHeight : $rule.defined(a.style.posHeight) && 0 < a.style.posHeight ? a.style.posHeight : $rule.defined(a.style.height) && 0 < a.style.height.length ? parseInt(a.style.height.substr(0, a.style.height.length - 2), 10) : 50; };
    $rule.getWindowDimensions = function() {
        var a = 0, d = 0;
        self.innerHeight ? (a = window.innerHeight, d = window.innerWidth) : document.documentElement && document.documentElement.clientHeight ? (a = document.documentElement.clientHeight, d = document.documentElement.clientWidth) : document.body && (a = document.body.clientHeight, d = document.body.clientWidth);
        return { height: parseInt(a, 10), width: parseInt(d, 10) };
    };
    $rule.getScrollWidth = function() {
        var a = window.pageXOffset || document.body.scrollLeft || document.documentElement.scrollLeft;
        return a ? a : 0;
    };
    $rule.getScrollHeight = function() {
        var a = window.pageYOffset || document.body.scrollTop || document.documentElement.scrollTop;
        return a ? a : 0;
    };
    $rule.position = function(a, d) {
        var e = $rule.getBounds(a), j = $rule.getBounds(d), h = $rule.getWindowDimensions(), q = $rule.getScrollHeight(), k = $rule.getScrollWidth();
        d.style.top = h.height > e.y - q + e.height + j.height ? e.y + e.height + "px" : h.height - j.height + q - 4 + "px";
        d.style.left = h.width > e.x - k + e.width + j.width ? e.x + e.width + 6 + "px" : h.width - j.width + k - 4 + "px";
    };
    $rule.leftAlign = function(a, d) {
        var e = $rule.getBounds(a), j = $rule.getBounds(d), h = $rule.getWindowDimensions(), q = $rule.getScrollWidth();
        d.style.left = h.width > e.x - q + e.width + j.width ? e.x + "px" : h.width - j.width + q - 4 + "px";
    };
    $rule.getType = function(a) {
        if (!$rule.defined(a.constructor)) throw Error("CL1");
        a = String(a.constructor).match(/function\s+(\w+)/);
        return $rule.defined(a) ? a[1] : "undefined";
    };
    $rule.getDocument = function(a) {
        a = a.ownerDocument || a.document || a;
        return a.defaultView || a.parentWindow;
    };
    $rule.getStyle = function(a) {
        if (3 === a.nodeType) return null;
        var d = $rule.getDocument(a);
        a.documentElement && (a = a.documentElement);
        var e = d && a !== d && d.getComputedStyle ? d.getComputedStyle(a, null) : a.currentStyle || a.style;
        if (!e && $rule.Client.browser == $rule.Client.type.Chrome && a.style) {
            var e = a.style.display, j = a.style.position;
            a.style.position = "absolute";
            a.style.display = "block";
            d = d.getComputedStyle(a, null);
            a.style.display = e;
            a.style.position = j;
            var e = {}, h;
            for (h in d) e[h] = d[h];
            e.display = "none";
        }
        return e;
    };
    $rule.getParentById = function(a, d) { return !$rule.defined(a) ? null : a.id && a.id == d ? a : a.parentNode ? $rule.getParentById(a.parentNode, d) : null; };
    $rule.getParentByTagName = function(a, d, e) {
        $rule.defined(e) || (e = 0);
        return 0 < e && a.tagName && a.tagName == d ? a : a.parentNode ? $rule.getParentByTagName(a.parentNode, d, ++e) : null;
    };
    $rule.getChildrenByTagName = function(a, d, e) {
        var j = [], h;
        if (a.childNodes)
            for (var q = 0; q < a.childNodes.length; q++)
                if (h = a.childNodes[q], h.tagName && h.tagName == d && j.push(h), e && h.childNodes && 0 < h.childNodes.length) {
                    h = $rule.getChildrenByTagName(h, d, e);
                    for (var k in h) j.push(h[k]);
                }
        return j;
    };
    $rule.getChildrenByAttribute = function(a, d, e) {
        for (var j = [], h, q, k = 0; k < a.childNodes.length; k++)
            if (h = a.childNodes[k], h.tagName && h.getAttribute && (q = h.getAttribute(d)) && (!$rule.defined(e) || q == e) && j.push(h), 0 < h.childNodes.length) {
                h = $rule.getChildrenByAttribute(h, d, e);
                for (var u in h) j.push(h[u]);
            }
        return j;
    };
    $rule.StringBuilder = function() {
        var a = [];
        this.append = function(d) {
            d = $rule.defined(d) ? $rule.getType(d) != $rule.getType(new String) ? String(d) : d : "";
            0 < d.length && (a[a.length] = d);
        };
        this.dump = function() { return a.join(""); };
    };
    $rule.Point = function(a, d) {
        this.x = a;
        this.y = d;
    };
    switch ($rule.Client.browser) {
    case $rule.Client.type.IE:
        $rule.getPosition = function(a) {
            if (a.self || 9 === a.nodeType) return new $rule.Point(0, 0);
            var d = { bottom: 0, height: 0, left: 0, right: 0, top: 0, width: 0 };
            try {
                d = a.getBoundingClientRect();
            } catch(e) {
            }
            if (!d) return new $rule.Point(0, 0);
            var j = a.ownerDocument.documentElement, h = d.left - 2 + j.scrollLeft, d = d.top - 2 + j.scrollTop;
            try {
                var q = a.ownerDocument.parentWindow.frameElement || null;
                if (q) var k = "0" === q.frameBorder || "no" === q.frameBorder ? 2 : 0, h = h + k, d = d + k;
            } catch(u) {
            }
            return new $rule.Point(h,
                d);
        };
        break;
    case $rule.Client.type.Chrome:
        $rule.getPosition = function(a) {
            if (a.window && a.window === a || 9 === a.nodeType) return new $rule.Point(0, 0);
            for (var d = 0, e = 0, j = null, h, q = a; q; j = h, q = q.offsetParent) {
                h = $rule.getStyle(q);
                var k = q.tagName ? q.tagName.toUpperCase() : null;
                if ((q.offsetLeft || q.offsetTop) && ("BODY" !== k || !j || "absolute" !== j.position)) d += q.offsetLeft, e += q.offsetTop;
            }
            h = (h = $rule.getStyle(a)) ? h.position : null;
            if (!h || "absolute" !== h)
                for (a = a.parentNode; a; a = a.parentNode) {
                    k = a.tagName ? a.tagName.toUpperCase() : null;
                    if ("BODY" !== k && "HTML" !== k && (a.scrollLeft || a.scrollTop)) d -= a.scrollLeft || 0, e -= a.scrollTop || 0;
                    if ((h = (h = $rule.getStyle(a)) ? h.position : null) && "absolute" === h) break;
                }
            return new $rule.Point(d, e);
        };
        break;
    case $rule.Opera:
        $rule.getPosition = function(a) {
            if (a.window && a.window === a || 9 === a.nodeType) return new $rule.Point(0, 0);
            for (var d = 0, e = 0, j = a; j; j = j.offsetParent) var h = j.tagName, d = d + (j.offsetLeft || 0), e = e + (j.offsetTop || 0);
            j = (h = a.style.position) && "static" !== h;
            for (a = a.parentNode; a; a = a.parentNode) {
                h = a.tagName ? a.tagName.toUpperCase() :
                    null;
                if ("BODY" !== h && "HTML" !== h && (a.scrollLeft || a.scrollTop) && j && ("scroll" === a.style.overflow || "auto" === a.style.overflow)) d -= a.scrollLeft || 0, e -= a.scrollTop || 0;
                h = a && a.style ? a.style.position : null;
                j = j || h && "static" !== h;
            }
            return new $rule.Point(d, e);
        };
        break;
    default:
        $rule.getPosition = function(a) {
            if (a.window && a.window === a || 9 === a.nodeType) return new $rule.Point(0, 0);
            for (var d = 0, e = 0, j = null, h = null, q = null, k = a; k; j = k, h = q, k = k.offsetParent) {
                var u = k.tagName ? k.tagName.toUpperCase() : null, q = $rule.getStyle(k);
                if ((k.offsetLeft ||
                    k.offsetTop) && !("BODY" === u && (!h || "absolute" !== h.position))) d += k.offsetLeft, e += k.offsetTop;
                if (null !== j && q && ("TABLE" !== u && ("TD" !== u && "HTML" !== u) && (d += parseInt(q.borderLeftWidth) || 0, e += parseInt(q.borderTopWidth) || 0), "TABLE" === u && ("relative" === q.position || "absolute" === q.position))) d += parseInt(q.marginLeft) || 0, e += parseInt(q.marginTop) || 0;
            }
            q = (q = $rule.getStyle(a)) ? q.position : null;
            if (!q || "absolute" !== q)
                for (a = a.parentNode; a; a = a.parentNode)
                    if (u = a.tagName ? a.tagName.toUpperCase() : null, "BODY" !== u && "HTML" !== u &&
                        (a.scrollLeft || a.scrollTop)) if (d -= a.scrollLeft || 0, e -= a.scrollTop || 0, q = $rule.getStyle(a)) d += parseInt(q.borderLeftWidth) || 0, e += parseInt(q.borderTopWidth) || 0;
            return new $rule.Point(d, e);
        };
    }
    $rule.getBounds = function(a) {
        var d = $rule.getPosition(a);
        return { x: d.x, y: d.y, width: $rule.getElementWidth(a), height: $rule.getElementHeight(a) };
    };
    $rule.Json = function() {
        this.serialize = function(d) {
            var e = new $rule.StringBuilder;
            a(d, e, !1);
            return e.dump();
        };
        this.deserialize = function(a) {
            if (!$rule.defined(a) || 0 == a.length) throw Error("CL2");
            try {
                return eval("(" + a.replace(/\\"/g, '"') + ")");
            } catch(e) {
                throw Error("CL41");
            }
        };
        var a = function(d, e) {
            var j;
            switch (typeof d) {
            case "number":
                isFinite(d) ? e.append(d.toString()) : e.append("null");
                break;
            case "string":
                e.append('"');
                e.append(d);
                e.append('"');
                break;
            case "boolean":
                e.append(d.toString());
                break;
            case "object":
                if ($rule.defined(d))
                    if ($rule.getType(d) ==
                        $rule.getType([])) {
                        e.append("[");
                        for (j = 0; j < d.length; ++j) 0 < j && e.append(","), a(d[j], e);
                        e.append("]");
                    } else {
                        var h = [], q = 0;
                        for (j in d) h[q++] = j;
                        e.append("{");
                        var k = !1;
                        for (j = 0; j < q; j++) {
                            var u = d[h[j]];
                            $rule.defined(u) && "function" !== typeof u && (k ? e.append(",") : k = !0, a(h[j], e), e.append(":"), a(u, e));
                        }
                        e.append("}");
                    }
                else e.append("null");
                break;
            default:
                e.append("null");
            }
        };
    };
    $rule.formatDate = function(a, d) {
        function e(b) { return 10 > b ? "0" + b : b.toString(); }
        function j(b) { return 10 > b ? "00" + b : 100 > b ? "0" + b : b.toString(); }
        if (!d || 0 === d.length || "i" === d) return a.toString();
        d = function(b) {
            $rule.defined(b) || (b = "d");
            if (1 == b.length)
                switch (b) {
                case "F":
                    return "dddd, MMMM dd, yyyy h:mm:ss tt";
                case "s":
                    return "yyyy'-'MM'-'dd'T'HH':'mm':'ss";
                case "Y":
                case "y":
                    return "MMMM, yyyy";
                case "M":
                case "m":
                    return "MMMM dd";
                case "d":
                    return "M/d/yyyy";
                case "D":
                    return "dddd, MMMM dd, yyyy";
                case "t":
                    return "h:mm tt";
                case "T":
                    return "h:mm:ss tt";
                default:
                    throw Error("CL61");
                }
            return b;
        }(d);
        for (var h = new $rule.StringBuilder, q, k = 0, u = /dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z/g;;) {
            var f = u.lastIndex;
            q = u.exec(d);
            for (var f = d.slice(f, q ? q.index : d.length), n = h, b = 0, v = !1, K = 0, C = f.length; K < C; K++) {
                var N = f.charAt(K);
                switch (N) {
                case "'":
                    v ? n.append("'") : b++;
                    v = !1;
                    break;
                case "\\":
                    v && n.append("\\");
                    v = !v;
                    break;
                default:
                    n.append(N), v = !1;
                }
            }
            k += b;
            if (!q) break;
            if (1 === k % 2) h.append(q[0]);
            else
                switch (q[0]) {
                case "MMMM":
                    h.append($rule.monthNames[a.getMonth()]);
                    break;
                case "MMM":
                    h.append($rule.abbrMonthNames[a.getMonth()]);
                    break;
                case "MM":
                    h.append(e(a.getMonth() + 1));
                    break;
                case "M":
                    h.append(a.getMonth() + 1);
                    break;
                case "dddd":
                    h.append($rule.dayNames[a.getDay()]);
                    break;
                case "ddd":
                    h.append($rule.abbrDayNames[a.getDay()]);
                    break;
                case "dd":
                    h.append(e(a.getDate()));
                    break;
                case "d":
                    h.append(a.getDate());
                    break;
                case "yyyy":
                    h.append(a.getFullYear());
                    break;
                case "yy":
                    h.append(e(a.getFullYear() % 100));
                    break;
                case "y":
                    h.append(a.getFullYear() % 100);
                    break;
                case "hh":
                    q = a.getHours() %
                        12;
                    0 === q && (q = 12);
                    h.append(e(q));
                    break;
                case "h":
                    q = a.getHours() % 12;
                    0 === q && (q = 12);
                    h.append(q);
                    break;
                case "HH":
                    h.append(e(a.getHours()));
                    break;
                case "H":
                    h.append(a.getHours());
                    break;
                case "mm":
                    h.append(e(a.getMinutes()));
                    break;
                case "m":
                    h.append(a.getMinutes());
                    break;
                case "ss":
                    h.append(e(a.getSeconds()));
                    break;
                case "s":
                    h.append(a.getSeconds());
                    break;
                case "tt":
                    h.append(12 > a.getHours() ? "AM" : "PM");
                    break;
                case "t":
                    h.append(12 > a.getHours() ? "A" : "P");
                    break;
                case "f":
                    h.append(j(a.getMilliseconds()).charAt(0));
                    break;
                case "ff":
                    h.append(j(a.getMilliseconds()).substr(0, 2));
                    break;
                case "fff":
                    h.append(j(a.getMilliseconds()));
                    break;
                case "z":
                    q = a.getTimezoneOffset() / 60;
                    h.append((0 >= q ? "+" : "-") + Math.floor(Math.abs(q)));
                    break;
                case "zz":
                    q = a.getTimezoneOffset() / 60;
                    h.append((0 >= q ? "+" : "-") + e(Math.floor(Math.abs(q))));
                    break;
                case "zzz":
                    q = a.getTimezoneOffset() / 60, h.append((0 >= q ? "+" : "-") + e(Math.floor(Math.abs(q))) + ":" + e(Math.abs(a.getTimezoneOffset() % 60)));
                }
        }
        return h.dump();
    };
    Function.addDelegate = function(a, d) { return function() { return d.apply(a, arguments); }; };
    $rule.Event = function(a) {
        a = a || window.event;
        var d = this.type = a.type.toLowerCase();
        this.rawEvent = a;
        "keypress" == d && (this.charCode = a.charCode || a.keyCode);
        a.keyCode ? this.keyCode = 46 == a.keyCode && "keypress" != d ? 127 : a.keyCode : a.charCode ? this.keyCode = a.charCode : "undefined" != typeof a.which && (this.keyCode = a.which);
        this.offsetY = a.pageY ? a.pageY : a.clientY + document.body.scrollTop - document.body.clientTop;
        this.target = a.target ? a.target : a.srcElement;
    };
    $rule.Event.prototype = { preventDefault: function() { this.rawEvent.preventDefault ? this.rawEvent.preventDefault() : window.event && (this.rawEvent.returnValue = !1); }, stopPropagation: function() { this.rawEvent.stopPropagation ? this.rawEvent.stopPropagation() : window.event && (this.rawEvent.cancelBubble = !0); } };
    $rule.addHandler = function (a, d, e) {
        // console.log('new handler', a, d, e);
        a.ceEvents || (a.ceEvents = {});
        var j = a.ceEvents[d];
        j || (a.ceEvents[d] = j = []);
        var h;
        if (a.addEventListener) {
            h = function (d) {
                return e.call(a, new $rule.Event(d));
            }
            a.addEventListener(d, h, !1);
        } else {
            if (a.attachEvent) {
                h = function () {
                    var d = {};
                    try {
                        d = $rule.getDocument(a).event;
                    } catch (h) {

                    }
                    return e.call(a, new $rule.Event(d));
                }

                a.attachEvent("on" + d, h);
            }
        }
        j[j.length] = { handler: e, browserHandler: h };
    };
    $rule.addHandlers = function(a, d, e) {
        for (var j in d) {
            var h = d[j];
            e && (h = Function.addDelegate(e, h));
            $rule.addHandler(a, j, h);
        }
    };
    $rule.Context = {
        controls: [],
        addControl: function(a, d) {
            for (var e in $rule.Context.controls) if ($rule.Context.controls[e].id == a) throw Error("Web Rule control with specified ID already exist in the current context (CL85)");
            $rule.Context.controls.push(new $rule.Context.Item(a, d));
        },
        getControl: function(a) {
            for (var d in $rule.Context.controls) if ($rule.Context.controls[d].id == a) return $rule.Context.controls[d].ref;
            return null;
        }
    };
    $rule.Context.Item = function(a, d) {
        this.id = a;
        this.ref = d;
    };
    var $ce = $rule.Context.getControl;
    $rule.Menu.Item = function() { this.Type = this.Name = this.ID = null; };
    $rule.Menu.Control = function(a) {
        var d = $rule, e, j, h, q, k, u, f, n, b = null, v = !1, K = d.highlight, C = d.dim, N = d.getElementHeight, w = d.defined, A = d.Client.browser == d.Client.type.IE, t = d.Client.browser == d.Client.type.Opera;
        this.init = function(e, a) {
            b = e;
            u = a;
            t ? d.addHandlers(document, { keydown: D, keypress: y }, b) : d.addHandlers(document, { keydown: D }, b);
        };
        this.close = function() {
            qa();
            u && u();
        };
        this.select = function(b) {
            if (e)
                for (var a = 0; a < j.rows.length; a++)
                    if (0 === j.rows[a].cells[0].innerHTML.toLowerCase().lastIndexOf(b.toLowerCase(), 0)) {
                        Y(j.rows[a]);
                        break;
                    }
        };
        this.fill = function(b, t, B, u, T, I) {
            if (w(t) && 0 != t.length) {
                v = !0;
                q = B;
                k = I;
                f = u;
                n = T;
                j = document.createElement("TABLE");
                j.id = "ce106" + b.id;
                e = document.createElement("DIV");
                e.id = "ce107" + b.id;
                e.style.backgroundColor = "#fff";
                w(a) && (e.className = a);
                j.cellSpacing = 0;
                j.cellPadding = 2;
                j.border = 0;
                e.style.position = "absolute";
                e.style.padding = "2px";
                e.style.overflow = "auto";
                e.appendChild(j);
                document.body.appendChild(e);
                h = -1;
                e.style.width = j.style.width = "";
                A || (e.style.height = "");
                for (var D in t)
                    T = t[D], B = j.insertRow(-1), B.id =
                        "ce104" + b.id + D, B.setAttribute("ce101", w(T.ID) ? T.ID : ""), B.setAttribute("ce102", w(T.Type) ? T.Type : ""), B.setAttribute("ce103", D), B.onclick = function(b) {
                            b = b || window.event;
                            b.cancelBubble = !0;
                            q && q(this.getAttribute("ce101"), this.getAttribute("ce102"));
                        }, B.onmouseover = function() {
                            Y(this);
                            k && k(this.getAttribute("ce101"));
                        }, B.onmouseout = function() { C(this); }, u = B.insertCell(-1), u.id = "ce105" + b.id + D, A && 8 < d.Client.version && (B.style.height = "22px", u.style.fontSize = "13px", u.style.fontFamily = "Tahoma,Geneva,Arial,sans-serif"),
                    u.style.cursor = "default", u.style.paddingLeft = u.style.paddingRight = "8px", u.style.whiteSpace = "nowrap", u.innerHTML = T.Name;
                if (0 < j.rows.length) {
                    D = 12 < t.length;
                    B = N(j.rows[0]);
                    if (!w(B) || 0 == B) B = 22;
                    e.style.height = B * (D ? 12 : t.length) + "px";
                    d.position(b, e);
                    b = $rule.getBounds(j);
                    b = D ? d.getScrollBarWidth() + b.width : b.width;
                    e.style.width = b + "px";
                    e.scrollTop = j.rows[0].offsetTop;
                    e.onclick = function(b) {
                        b = b || window.event;
                        b.cancelBubble = !0;
                        return !1;
                    };
                } else qa();
            }
        };
        this.alignLeft = function(b) { w(e) && w(b) && d.leftAlign(b, e); };
        var D =
                function(b) {
                    var a = b.keyCode;
                    if (!v || !w(e) || 0 == j.rows.length) return !0;
                    switch (a) {
                    case 13:
                        w(f) && f();
                        -1 < h ? q && q(j.rows[h].getAttribute("ce101"), j.rows[h].getAttribute("ce102")) : n && n();
                        break;
                    case 32:
                        -1 < h && q && q(j.rows[h].getAttribute("ce101"), j.rows[h].getAttribute("ce102"));
                        break;
                    case 38:
                        -1 == h && (h = 0);
                        if (0 <= h) {
                            var d = j.rows[h].offsetTop - e.scrollTop < j.rows[0].cells[0].clientHeight;
                            h--;
                            0 > h && (h = 0);
                            d && (e.scrollTop = j.rows[h].offsetTop);
                            $();
                        }
                        break;
                    case 40:
                        d = j.rows[0].cells[0].clientHeight, d = e.scrollTop + 11 * d - h * d <
                            d, h++, h > j.rows.length - 1 && (h = j.rows.length - 1), d && (e.scrollTop = j.rows[h - 12 + 1].offsetTop), $();
                    }
                    if (!t && (8 == a || 9 == a || 13 == a || 32 == a || 33 == a || 34 == a || 35 == a || 36 == a || 38 == a || 40 == a)) b.preventDefault && b.preventDefault(), b.stopPropagation && b.stopPropagation();
                }, y = function(b) {
                    if (!v || !w(e) || 0 == j.rows.length) return !0;
                    var a = b.keyCode;
                    (8 == a || 9 == a || 13 == a || 32 == a || 33 == a || 34 == a || 35 == a || 36 == a || 38 == a || 40 == a) && b.preventDefault();
                    return !1;
                }, $ = function() {
                    I();
                    var b = j.rows[h];
                    K(b);
                    k && k(b.getAttribute("ce101"));
                }, Y = function(b) {
                    h = parseInt(b.getAttribute("ce103"),
                        10);
                    I();
                    K(b);
                }, qa = function() {
                    w(e) && w(e.parentNode) && e.parentNode.removeChild(e);
                    v = !1;
                }, I = function() { for (var b = 0; b < j.rows.length; b++) C(j.rows[b]); };
    };
    $rule.Time.Settings = function(a) {
        this.us = -1 < a.indexOf("t");
        this.h = -1 < a.indexOf("h") || -1 < a.indexOf("H");
        this.m = -1 < a.indexOf("m");
        this.s = -1 < a.indexOf("s");
        this.dp = this.h || this.m || this.s;
    };
    $rule.Time.Picker = function(a) {
        var d = $rule, e = null, j, h, q, k, u, f = !1, n, b, v, K = new Date;
        n = K.getHours();
        b = K.getMinutes();
        v = K.getSeconds();
        this.defaultFormat = function() { return e ? e.defaultFormat() : "hh:mm tt"; };
        this.show = function(w, A, t, D, y) {
            k = w;
            q = A;
            u = d.defined(t) ? t : "hh:mm tt";
            f = D;
            d.defined(y) && (n = y.getHours(), b = y.getMinutes(), v = y.getSeconds());
            j = document.createElement("TABLE");
            j.id = "ce110" + k.id;
            j.insertRow(-1).insertCell(-1);
            d.defined(a) && (j.className = a);
            j.cellSpacing = 0;
            j.cellPadding = 2;
            j.style.position = "absolute";
            h = document.createElement("TABLE");
            h.id = "ce111" + k.id;
            h.setAttribute("ce108", "true");
            h.cellSpacing = 0;
            h.cellPadding = 2;
            w = h.insertRow(-1).insertCell(-1);
            w.style.padding = "2px 6px 2px 6px";
            e = new d.Time.Control(w, u, C);
            e.setValue(n, b, v);
            j.rows[0].cells[0].appendChild(h);
            document.body.appendChild(j);
            j.onclick = function(b) {
                b = b || window.event;
                b.cancelBubble = !0;
                return !1;
            };
            N();
        };
        this.hide = function() { d.defined(j) && d.defined(j.parentNode) && j.parentNode.removeChild(j); };
        this.position = function() { N(); };
        this.getId = function() {
            return d.defined(j) ?
                j.id : null;
        };
        var C = function() {
            K = e.getRawValue();
            n = K.getHours();
            b = K.getMinutes();
            v = K.getSeconds();
            d.defined(q) && q(e.getValue(), e.getText());
        }, N = function() { d.defined(k) && (d.position(k, j), f && d.leftAlign(k, j)); };
    };
    $rule.Time.Control = function(a, d, e) {
        function j(b, e, a) {
            if (f.defined(b) && f.defined(b.options) && 0 != b.options.length) {
                for (var d = !1, h = 0; h < b.options.length; h++)
                    if (!a && b.options[h].text == e || a && b.options[h].value == e) {
                        b.selectedIndex = h;
                        d = !0;
                        break;
                    }
                d || (b.selectedIndex = 0);
            }
        }
        function h(b) { return !f.defined(b) || !f.defined(b.options) || -1 == b.selectedIndex ? null : b.options[b.selectedIndex].value; }
        function q(b) { return !f.defined(b) || !f.defined(b.options) || -1 == b.selectedIndex ? null : b.options[b.selectedIndex].text; }
        function k(b,
            e, a) {
            var d = document.createElement("OPTION");
            d.text = e;
            d.value = a;
            f.Client.browser == f.Client.type.IE ? b.options.add(d) : b.appendChild(d);
        }
        function u(b, e, a, f) {
            for (e -= 1; e < a; e++) {
                var d = e + 1;
                k(b, f && 10 > d ? "0" + d : d, d);
            }
        }
        var f = $rule;
        d = f.defined(d) ? d : "hh:mm tt";
        var n = new f.Time.Settings(d), b = function() {
            if (!n.h) return 0;
            if (n.us) {
                var b = parseInt(h(C), 10);
                return "AM" == h(A) ? 12 == b ? 0 : b : 12 == b ? b : b + 12;
            }
            return parseInt(h(C), 10);
        }, v = function(b) {
            var e = document.createElement("SELECT");
            e.id = b;
            e.style.width = "44px";
            a.appendChild(e);
            u(e,
                0, 59, !0);
            return e;
        }, K = function() {
            var b = document.createElement("SPAN");
            b.innerHTML = "<b>:</b>";
            b.style.marginLeft = "2px";
            b.style.marginRight = "2px";
            a.appendChild(b);
        }, C = null, N = null, w = null, A = null;
        n.h && (C = document.createElement("SELECT"), C.id = "ce113" + a.id, C.style.width = "44px", a.appendChild(C), n.us ? (k(C, "12", 12), u(C, 1, 11, !1)) : u(C, 0, 23, !0));
        n.h && n.m && K();
        n.m && (N = v("ce114" + a.id));
        n.s && (K(), w = v("ce115" + a.id));
        n.h && n.us && (A = document.createElement("SELECT"), A.id = "ce116" + a.id, A.style.width = "44px", A.style.marginLeft =
            "4px", a.appendChild(A), k(A, "AM", "AM"), k(A, "PM", "PM"));
        v = document.createElement("INPUT");
        v.id = "ce112" + a.id;
        v.type = "button";
        v.style.marginLeft = "4px";
        v.value = "OK";
        a.appendChild(v);
        v.onclick = function(b) {
            b = b || window.event;
            b.cancelBubble = !0;
            e();
        };
        this.defaultFormat = function() { return "hh:mm tt"; };
        this.getRawValue = function() { return new Date("1/1/2000 " + b() + ":" + (n.m ? q(N) : "00") + ":" + (n.s ? q(w) : "00")); };
        this.getValue = function() { return f.formatDate(this.getRawValue(), "HH:mm:ss"); };
        this.getText = function() {
            var b = (n.h ?
                q(C) : "00") + ":" + (n.m ? q(N) : "00") + ":" + (n.s ? q(w) : "00") + (n.h && n.us ? " " + q(A) : "");
            return f.formatDate(new Date("1/1/2000 " + b), d);
        };
        this.setValue = function(b, e, a) {
            if (!f.defined(b) || !f.defined(e) || !f.defined(a) || 0 == b.length || 0 == e.length || 0 == a.length) n.h && (C.selectedIndex = 0), n.m && (N.selectedIndex = 0), n.s && (w.selectedIndex = 0), n.h && n.us && (A.selectedIndex = 0);
            else {
                if (n.h)
                    if (n.us) {
                        b = parseInt(b, 10);
                        var d = b - 12;
                        13 > b ? (d = 0 == b ? 12 : b, j(A, "AM", !0)) : j(A, "PM", !0);
                        j(C, d, !0);
                    } else 2 > b.length ? j(C, b, !0) : j(C, b, !1);
                n.m && (2 > e.length ?
                    j(N, e, !0) : j(N, e, !1));
                n.s && (2 > a.length ? j(w, a, !0) : j(w, a, !1));
            }
        };
    };
    $rule.TextBox.Settings = function(a, d, e, j, h, q, k, u) {
        this.parent = a;
        this.id = d;
        this.css = e;
        this.defCss = j;
        this.max = h;
        this.defVal = q;
        this.errVal = k;
        this.errColor = u;
    };
    $rule.TextBox.Control = function() {
        var a, d;
        this.init = function(e) {
            d = e;
            a = document.createElement("INPUT");
            a.type = "text";
            a.id = d.id;
            a.className = d.defCss;
            a.maxLength = d.max;
            a.value = d.defVal;
            d.parent.appendChild(a);
            a.onfocus = function() {
                a.className = a.className.replace(" " + d.errColor, "");
                a.className = d.css;
                if (a.value.toLowerCase() == d.defVal.toLowerCase() || a.value.toLowerCase() == d.errVal.toLowerCase()) a.value = "";
            };
            a.onblur = function() {
                var e = $rule.trim(a.value);
                if (0 == e.length || e.toLowerCase() == d.defVal.toLowerCase() ||
                    e.toLowerCase() == d.errVal.toLowerCase()) a.className = a.className.replace(" " + d.errColor, ""), a.value = d.defVal, a.className = d.defCss;
            };
        };
        this.getValue = function() { return a.value; };
        this.setValue = function(e) { a.value = e; };
        this.setClass = function(e) { a.className = e; };
    };
    $rule.Calendar.Css = function() {
        this.container = "ceCal";
        this.header = "ceHeader";
        this.day = "ceDay";
        this.today = "ceToday";
        this.selected = "ceSelected";
        this.dayRollover = "ceRollover";
        this.weekDays = "ceDays";
    };
    $rule.Calendar.Control = function() {
        var a = $rule, d, e, j, h, q = !1, k = new a.Calendar.Css, u, f, n, b, v, K, C, N, w, A, t, D = new Date;
        u = D.getMonth();
        f = D.getFullYear();
        n = D.getHours();
        b = D.getMinutes();
        v = D.getSeconds();
        K = D.getDate();
        C = N = 0;
        this.show = function(I, G, X, B, D) {
            d = I;
            j = G;
            h = a.defined(X) ? X : "MMM dd, yyyy";
            q = B;
            a.defined(D) && (K = D.getDate(), N = f = D.getFullYear(), C = u = D.getMonth(), n = D.getHours(), b = D.getMinutes(), v = D.getSeconds());
            t = document.createElement("TABLE");
            t.id = "ce120" + d.id;
            t.cellSpacing = 0;
            t.cellPadding = 1;
            I = t.insertRow(-1);
            I = I.insertCell(-1);
            a.defined(k.container) && (t.className = k.container);
            t.style.position = "absolute";
            w = document.createElement("TABLE");
            w.id = "ce121" + d.id;
            w.setAttribute("ce118", "true");
            a.defined(k.header) && (w.className = k.header);
            w.cellSpacing = w.cellPadding = 0;
            w.style.width = "100%";
            G = w.insertRow(-1);
            B = G.insertCell(-1);
            B.style.padding = "1px 0px 3px 6px";
            X = Y(B, "ce123" + d.id, "&#171;&#171;");
            X.style.marginRight = "4px";
            X.onclick = function(b) {
                b = b || window.event;
                b.cancelBubble = !0;
                --f;
                y();
            };
            B = Y(B, "ce124" + d.id, "&#171;");
            B.style.marginLeft = "2px";
            B.onclick = function(b) {
                b = b || window.event;
                b.cancelBubble = !0;
                0 == u ? (u = 11, --f) : --u;
                y();
            };
            X.style.cursor = B.style.cursor = "pointer";
            B = G.insertCell(-1);
            B.style.width = "90px";
            B.style.textAlign = "center";
            B.style.padding = "1px 0px 3px 0px";
            X = Y(B, "ce125" + d.id, a.abbrMonthNames[u]);
            B = Y(B, "ce126" + d.id, f);
            X.style.marginRight = "2px";
            B.style.marginLeft = "2px";
            X.style.cursor = B.style.cursor = "default";
            X = G.insertCell(-1);
            X.style.padding = "1px 6px 3px 0px";
            X.style.textAlign = "right";
            G = Y(X, "ce127" + d.id, "&#187;");
            G.style.marginRight = "2px";
            G.onclick = function(b) {
                b = b || window.event;
                b.cancelBubble = !0;
                11 == u ? (u = 0, ++f) : ++u;
                y();
            };
            X = Y(X, "ce128" + d.id, "&#187;&#187;");
            X.style.marginLeft = "4px";
            X.onclick = function(b) {
                b = b || window.event;
                b.cancelBubble = !0;
                ++f;
                y();
            };
            X.style.cursor = G.style.cursor = "pointer";
            I.appendChild(w);
            I = document.createElement("TABLE");
            I.id = "ce148" + d.id;
            I.cellSpacing = 1;
            I.cellPadding = 0;
            I.style.width = "100%";
            for (B = 0; 7 > B; B++) {
                G = I.insertRow(-1);
                for (D = 0; 7 > D; D++)
                    X = G.insertCell(-1), 0 == B && a.defined(k.weekDays) && (X.className =
                        k.weekDays), X.innerHTML = "&nbsp;";
            }
            for (G = 0; G < I.rows[0].cells.length; G++) I.rows[0].cells[G].innerHTML = a.abbrWeekDayNames[G];
            t.rows[0].cells[0].appendChild(I);
            A = I;
            document.body.appendChild(t);
            (new a.Time.Settings(h)).dp && (I = t.insertRow(-1), I = I.insertCell(-1), I.style.padding = "0 4px 6px 4px", I.style.textAlign = "center", e = new a.Time.Control(I, h, $), e.setValue(n, b, v));
            qa();
            y();
        };
        this.hide = function() { a.defined(t) && a.defined(t.parentNode) && t.parentNode.removeChild(t); };
        this.position = function() { qa(); };
        this.defaultFormat =
            function() { return "MMM dd, yyyy"; };
        this.getId = function() { return a.defined(t) ? t.id : null; };
        var y = function() {
            var b = a.getChildrenByTagName(w.rows[0].cells[1], "SPAN", !1);
            b[0].innerHTML = a.abbrMonthNames[u];
            b[1].innerHTML = f;
            var e = new Date, d = new Date(f, u, 1), b = e.getFullYear(), j = e.getMonth(), e = e.getDate(), d = d.getDay(), n, q = 1, v, t = !0;
            n = 1 == u && (0 == f % 4 && 0 != f % 100 || 0 == f % 400) ? 29 : a.days[u];
            for (var D = 1; D < A.rows.length; D++)
                for (var y = 0; y < A.rows[D].cells.length; y++)
                    v = A.rows[D].cells[y],
                        t = !0,
                        1 == D && y >= d || 1 < D && q <= n
                            ? (v.innerHTML = q, b == f && j == u && q == e && a.defined(k.today)
                                ? (v.className = k.today, v.setAttribute("ce117", k.today), t = !1)
                                : f == N && u == C && q == K && a.defined(k.selected)
                                    ? (v.className = k.selected, v.setAttribute("ce117", k.selected), t = !1)
                                    : a.defined(k.day) && (v.className = k.day),

                        t && a.defined(k.day) && v.setAttribute("ce117", k.day),
                        v.onclick = function (b) {
                            var e = (new a.Time.Settings(h)).dp;
                            e || (b = b || window.event, b.cancelBubble = !0);
                            for (var f = 1; f < A.rows.length; f++)
                                for (var d = 0; d < A.rows[f].cells.length; d++)
                                    b = A.rows[f].cells[d], b.getAttribute("ce117") ==
                                        k.today ? b.className = k.today : (b.className = k.day, b.setAttribute("ce117", k.day));
                            K = parseInt(a.text(this), 10);
                            this.className != k.today && a.defined(k.selected) && (this.className = k.selected, this.setAttribute("ce117", k.selected));
                            e || $();
                        }, v.onmouseover = function () { a.defined(k.dayRollover) && (this.className = k.dayRollover); },
                        v.onmouseout = function () {
                            var b = this.getAttribute("ce117");
                            a.defined(b) && (this.className = b);
                        }, q++)
                            : (a.defined(k.day) && (v.className = k.day), v.innerHTML = "&nbsp;", v.onclick = v.onmouseover = v.onmouseout =
                            null);
        }, $ = function() {
            var d = u + 1 + "/" + K + "/" + f;
            D = new Date(d);
            u = D.getMonth();
            f = D.getFullYear();
            K = D.getDate();
            C = u;
            N = f;
            if ((new a.Time.Settings(h)).dp) {
                var k = e.getRawValue();
                n = k.getHours();
                b = k.getMinutes();
                v = k.getSeconds();
                d += " " + n + ":" + b + ":" + v;
            }
            a.defined(j) && j(d);
        }, Y = function(b, e, f) {
            var d = document.createElement("SPAN");
            a.defined(e) && (d.id = e);
            d.innerHTML = f;
            b.appendChild(d);
            return d;
        }, qa = function() { a.defined(d) && (a.position(d, t), q && a.leftAlign(d, t)); };
    };
    $rule.days = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
    $rule.dayNames = "Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");
    $rule.abbrDayNames = "Sun Mon Tue Wed Thu Fri Sat".split(" ");
    $rule.abbrWeekDayNames = "SMTWTFS".split("");
    $rule.monthNames = "January February March April May June July August September October November December ".split(" ");
    $rule.abbrMonthNames = "Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec ".split(" ");
    $rule.Settings = function(a) {
        this.help = a.ui[0];
        this.isEval = a.ui[1];
        this.evalIf = a.ui[2];
        this.execIf = a.ui[3];
        this.tools = a.ui[4];
        this.pb = a.ui[5];
        this.tochki = a.ui[6];
        this.clicks = a.ui[7];
        this.titles = a.ui[8];
        this.right = a.ui[9];
        this.tId = a.ui[10];
        this.tUrl = a.ui[11];
        this.els = a.s;
        this.clientFlds = [];
        this.ruleCss = "ceRule";
        this.menuCss = "ceMenu";
        this.toolCss = "ceToolBar";
        this.deleteCss = "ceDeleteButton";
        this.saveButCss = "ceSaveButton";
        this.rulesCss = "ceRulesButton";
        this.descCss = "ceDescriptionBox";
        this.nameCss = "ceNameBox";
        this.descDefCss = "ceDescriptionBoxDefault";
        this.nameDefCss = "ceNameBoxDefault";
        this.helpCss = "ceHelp";
        this.timeCss = "ceTime";
        this.flowCss = "ceFlow";
        this.fieldCss = "ceField";
        this.clauseCss = "ceClause";
        this.operCss = "ceOperator";
        this.skobkiCss = "ceParenthesis";
        this.actionCss = "ceAction";
        this.valueCss = this.calcCss = this.paramCss = "ceValue";
        this.tabCss = "ceTab";
        this.lineCss = "ceNewLine";
        this.currentBg = "ceCurrent";
        this.invalidColor = "ceError";
        this.highlightBg = "ceHighlight";
        this.warn = "ceWarn";
        this.emptyColor = "ceEmpty";
        this.cursorOuter = "ceCursorOuter";
        this.cursorInner = "ceCursorInner";
    };
    $rule.Control = function(a) {
        var d = $rule, elementType, functionType, operatorType, inputType, calculationType, valueInputType, f = null, n, b = null, v = null, K = [], C = [], N = [], w, A = null,
            t = null, D = null, y, $, Y, qa, I, G = !0, X = !0, B = null, Hb = null, T, ia, ua = null, Ia = 0,
            ic = !1, Ib = !1, da = null, Ja = !1, P = !1, fa = !1, L = !1, ib = 0, Za = 0, ka = 0, Jb = 0, Kb = 0,
            R = this, g = d.defined, Pa = new d.Json, pa, Ka, ya, jb, Lb = d.getChildrenByAttribute,
            S = "ce206", H = "ce208", mb = "C", Ea = "230rvb39ytkuFr", E = "", nb, kb, lb, Mb = !1,
            Nb = !1, Qa = null, Ob = null, Pb = null, Qb = null, $a = !1, targetElement = null, La = null, jc = null,
            elementId = a[0], Rb = a[1], kc = a[2], pb = a[3];
        
        R.loadSettings = function(c) {
            nb =
                c && c.d || c;
            loadSettingsInternal();
            return R;
        };
        R.loadRule = function(c) {
            lb = c && c.d || c;
            if (g(lb)) return Sb(), R;
        };
        R.loadInvalids = function(c) {
            kb = c && c.d || c;
            if (g(kb)) return Tb(), R;
        };
        R.setClientActions = function(c, b, e) {
            Ob = e;
            Pb = b;
            Qb = c;
            return R;
        };
        R.getRuleId = function() { return da; };
        R.isEvaluationType = function() { return f ? f.isEval : !0; };
        R.saved = function(c) {
            function b(c, p) { return c.Name.localeCompare(p.Name); }
            function e(c, b) { return c.n.localeCompare(b.n); }
            if (!$a) return R;
            !g(da) && g(c) && (da = c);
            g(da) && da != c && mc();
            c = [];
            var a, m = !1;
            if (f.tools) {
                for (var h in N)
                    a =
                        N[h], "ceEval" == a.ID || "ceExec" == a.ID || (a.ID == da && (a.Name = Ma(Y.getValue()), m = !0), c.push({ ID: a.ID, Name: a.Name }));
                m || (a = new d.Menu.Item, a.ID = da, a.Name = Ma(Y.getValue()), c.push(a));
                c.sort(b);
                f.els.rls = c;
                nc();
            }
            if (f.isEval) {
                var m = !1, j;
                for (j in f.els.fds)
                    if (a = f.els.fds[j], a.ir && a.v == da) {
                        a.n = Ma(Y.getValue());
                        m = !0;
                        break;
                    }
                m || (a = { n: Ma(Y.getValue()), v: da, o: 4, t: 1, ai: 2, ir: !0, l: !1 }, f.els.fds.push(a));
                f.els.fds.sort(e);
            }
            return R;
        };
        R.deleted = function(c) {
            var b = [], e, a;
            for (a in N) e = N[a], e.ID != c && b.push(e);
            N = b;
            if (f.isEval) {
                var b =
                        [], g;
                for (g in f.els.fds) e = f.els.fds[g], e.v != c && b.push(e);
                f.els.fds = b;
            }
            return R;
        };
        R.extract = function() {
            Qa = "ceExtract";
            Ja = !1;
            return Pa.serialize(qb());
        };
        R.clear = function() {
            oc();
            pc();
            Ra();
            return R;
        };
        R.dispose = function() {
            disposeInternal();
            return R;
        };
        R.redraw = function() {
            qc();
            rc();
            return R;
        };
        R.init = function(c) {
            nb = c;
            d.addHandlers(window, { load: loadSettingsInternal }, R);
        };
        R.load = function(c) { g(c) && (lb = c, d.addHandlers(window, { load: Sb }, R)); };
        R.invalid = function(c) { g(c) && (kb = c, d.addHandlers(window, { load: Tb }, R)); };
        R.valid = function() {
            Ub();
            bb();
        };
        R.post = function() { Vb(); };
        var loadSettingsInternal = function() {
            f = new $rule.Settings(Pa.deserialize(nb));
            nb = null;
            f.els.ens && 0 < f.els.ens.length && sc(f.els.ens, !0);
            f.els.mds && 0 < f.els.mds.length && sc(f.els.mds, !1);
            elementType = d.Client.ElementType;
            functionType = d.Client.FunctionType;
            operatorType = d.Models.OperatorType;
            inputType = d.Client.InputType;
            calculationType = d.Client.CalculationType;
            valueInputType = d.Common.ValueInputType;
            Ka = d.text;
            pa = $rule.getBounds;
            ya = d.Client.browser == d.Client.type.IE;
            jb = d.Client.browser == d.Client.type.Opera;
            Kb = 0;
            targetElement = document.getElementById(elementId);
            pb ? jc = document.getElementById(pb) :
                $a = !0;
            if ($a && g(f.tId) && g(f.tUrl)) {
                var c = Lb(document, f.tId);
                0 < c.length && (c[0].href = f.tUrl);
            }
            f.els.ms = f.help && g(d.Help) ? d.Help : {};
            f.els.er = d.Errors;
            !kc && !$a && (La = d.getParentByTagName(targetElement, "FORM"), g(La) && d.addHandlers(La, { submit: Vb }, this));
            f.tools ? (nc(), tc(!1), f.help ? uc(targetElement, !0) : vc()) : f.help ? tc(!0) : (y = document.getElementById("ceT" + targetElement.id), g(y) && y.parentNode.removeChild(y), y = null);
            var c = "_" + elementId, b = document.getElementById(c);
            g(b) || (b = document.createElement("DIV"), b.id = c);
            b.className = aa(f.ruleCss);
            targetElement.appendChild(b);
            targetElement = b;
            wc();
            n = 2;
            w = E;
            qc();
            if (!ic) {
                pc();
                c = Lb(document.body, "ce002");
                if (g(c) && 0 < c.length) {
                    if (Wb)
                        try {
                            t = c[0], t.id = Ia + E, Ia++;
                        } catch(a) {
                        }
                    for (b = 0; b < c.length; b++) c[b].style.display = "none";
                }
                if (Wb) {
                    xc();
                    try {
                        Hb = window.setInterval(xc, 400);
                    } catch(l) {
                        throw Error("CL92");
                    }
                }
                ua = new d.Menu.Control(f.menuCss);
                T = new d.Calendar.Control;
                ia = new d.Time.Picker(f.timeCss);
                d.addHandlers(document, { click: Uc }, this);
                d.addHandlers(document, { keydown: Vc, keypress: Wc, keyup: Xc }, this);
                ua.init(this, f.help ? bb : null);
                d.addHandlers(window, { resize: rc },
                    this);
                ic = !0;
            }
            Nb && Sb();
            Mb && Tb();
            Mb = Nb = !1;
        }, Sb = function() {
            if (g(f)) {
                var c = Pa.deserialize(lb);
                if (0 != c.length) {
                    da = c[0].g;
                    f.isEval = c[0].v;
                    if (f.tools) {
                        g(da) && mc();
                        var p = c[0].n, a = c[0].d;
                        g(p) && 0 < p.length ? (Y.setValue(Fa(p)), Y.setClass(aa(f.nameCss))) : (Y.setValue(Fa(f.els.lbl.n)), Y.setClass(aa(f.nameDefCss)));
                        g(a) && 0 < a.length ? (qa.setValue(Fa(a)), qa.setClass(aa(f.descCss))) : (qa.setValue(Fa(f.els.lbl.d)), qa.setClass(aa(f.descDefCss)));
                    }
                    Ia = c.length + 1;
                    yc();
                    for (var l, m, ab = null, s = null, ea = 0, w = 0, r = !1, u = null, t = 1; t < c.length; t++) {
                        p =
                            c[t];
                        if (!g(p)) break;
                        r = !1;
                        if (p.t == elementType.NewLine) Sa(!1, !0);
                        else if (p.t == elementType.Tab) O(p.t, null, E, "&nbsp;", null, null, null, null, !0);
                        else {
                            a = g(p.n) ? p.n : null;
                            switch (p.t) {
                            case elementType.Flow:
                                m = z(f.els.fls, p.v);
                                if (!g(m)) throw Error("CL10");
                                switch (p.v) {
                                case "if":
                                    l = f.isEval ? f.evalIf : f.execIf;
                                    break;
                                default:
                                    l = m.n;
                                }
                                break;
                            case elementType.LeftParenthesis:
                                l = "(";
                                break;
                            case elementType.RightParenthesis:
                                l = ")";
                                break;
                            case elementType.LeftBracket:
                                l = "{";
                                break;
                            case elementType.RightBracket:
                                l = "}";
                                break;
                            case elementType.Action:
                            case elementType.Function:
                                switch (p.f) {
                                case functionType.Name:
                                    w = 0;
                                    if (p.d)
                                        ea = 0, l = p.v, r =
                                            !0;
                                    else {
                                        m = z(p.t == elementType.Function ? f.els.fds : f.els.acs, p.v);
                                        if (!g(m)) throw Error("CL11");
                                        l = 0 < m.ps.length ? m.n + "&nbsp;(" : m.n;
                                        ea = m.ps.length;
                                        p.t == elementType.Function && (m.rt.o == operatorType.Enum ? v = eval(Ta(m.rt.e)) : m.rt.o == operatorType.Numeric && g(m.rt.mds) ? v = cb(m.rt.mds) : m.rt.o == operatorType.Date ? ab = m.rt.f : m.rt.o == operatorType.Time && (s = m.rt.f));
                                    }
                                    break;
                                case functionType.Param:
                                    if (p.i == inputType.Field) m = z(f.els.fds, p.v), g(m) ? l = m.n : (l = p.v, r = !0);
                                    else if (p.o == operatorType.String) l = '"' + p.v + '"';
                                    else if (p.o == operatorType.Numeric)
                                        m = ba(b), m.ps.length >= w && g(m.ps[w].mds) ? (l = cb(m.ps[w].mds), g(l) && 0 < l.length ? (p.i = inputType.Field,
                                        l = z(l, p.v), g(l) ? l = l.Name : (l = p.v, r = !0)) : (r = !0, l = p.v)) : l = "[" + p.v + "]";
                                    else if (p.o == operatorType.Date) l = d.formatDate(new Date(p.v), g(p.r) ? p.r : T.defaultFormat());
                                    else if (p.o == operatorType.Time) l = d.formatDate(new Date("1/1/2010 " + p.v), g(p.r) ? p.r : ia.defaultFormat());
                                    else if (p.o == operatorType.Enum) l = z(eval(Ta(p.e)), p.v).Name;
                                    else if (p.o == operatorType.Bool) l = sb(p.v);
                                    else throw Error("CL22");
                                    w++;
                                    break;
                                case functionType.Comma:
                                    l = ",";
                                    break;
                                case functionType.End:
                                    l = 0 < ea ? ")" : "&nbsp;";
                                    ea = w = 0;
                                    break;
                                default:
                                    throw Error("CL36");
                                }
                                break;
                            case elementType.Calculation:
                                switch (p.c) {
                                case calculationType.Field:
                                    m =
                                        z(f.els.fds, p.v);
                                    g(m) ? l = m.n : (l = p.v, r = !0);
                                    break;
                                case calculationType.Number:
                                    l = "[" + p.v + "]";
                                    break;
                                case calculationType.LeftParenthesis:
                                    l = "(";
                                    break;
                                case calculationType.RightParenthesis:
                                    l = ")";
                                    break;
                                case calculationType.Multiplication:
                                    l = "&#215;";
                                    break;
                                case calculationType.Division:
                                    l = "&#247;";
                                    break;
                                case calculationType.Addition:
                                    l = "+";
                                    break;
                                case calculationType.Subtraction:
                                    l = "&#150;";
                                    break;
                                default:
                                    throw Error("CL90");
                                }
                                break;
                            case elementType.Field:
                                p.d ? (l = p.v, v = ab = s = null, r = !0) : (m = z(f.els.fds, p.v), g(m) ? (v = p.o == operatorType.Enum ? g(p.e) ? eval(Ta(p.e)) : m.ens : p.o == operatorType.Numeric && g(m.mds) ? cb(m.mds) : null, ab = p.o == operatorType.Date && g(m.f) ? m.f : null,
                                s = p.o == operatorType.Time && g(m.f) ? m.f : null, l = m.n) : (l = p.v, v = ab = s = null));
                                break;
                            case elementType.Clause:
                                l = z(f.els.cls, p.v).n;
                                break;
                            case elementType.Operator:
                                l = zc(p.v, p.o);
                                g(l) ? l = l.n : (l = "is", r = !0);
                                break;
                            case elementType.Value:
                                p.o == operatorType.Enum ? !g(v) || 0 == v.length ? (l = "[Unknown]", r = !0) : (m = z(v, p.v), g(m) ? l = m.Name : (m = z(f.els.fds, p.v), g(m) ? l = m.n : (l = p.v, r = !0))) : p.i == inputType.Field ? (m = z(f.els.fds, p.v), g(m) ? l = m.n : (l = p.v, r = !0)) : p.o == operatorType.String ? l = '"' + p.v + '"' : p.o == operatorType.Numeric ? g(v) && 0 < v.length ? (p.i = inputType.Field, l = z(v, p.v), g(l) ? l = l.Name : (l = p.v, r = !0)) : l = "[" + p.v + "]" : l = p.o == operatorType.Date ?
                                    d.formatDate(new Date(p.v), g(ab) ? ab : T.defaultFormat()) : p.o == operatorType.Time ? d.formatDate(new Date("1/1/2010 " + p.v), g(s) ? s : ia.defaultFormat()) : sb(p.v);
                            }
                            O(p.t, a, Fa(p.v), Fa(l), p.o, p.c, p.f, p.i, !0);
                            va(p.t, p.o, p.c, p.i) && la();
                            r && (b.className = b.className + " " + aa(f.warn), u = f.els.er.e107);
                        }
                    }
                    v = lb = null;
                    n = 0;
                    disposeInternal();
                    g(u) && alert(u);
                }
            } else Nb = !0;
        }, Tb = function() {
            if (g(f)) {
                var c = Pa.deserialize(kb);
                if (0 != c.length) {
                    c[0].e && g(Y) && (Y.setValue(f.els.er.e104), Y.setClass(aa(f.nameCss) + " " + aa(f.invalidColor)));
                    for (var b = 1; b < c.length; b++) {
                        var e =
                                c[b], a = document.getElementById(e.c || e.ClientID);
                        g(a) && (a.className = a.className + " " + f.highlightBg, a.title = e.h || e.Hint, K.push(a.id));
                    }
                    f.help && (1 < c.length ? (db(f.els.er.e102), $.className = $.className + " " + aa(f.invalidColor)) : c[0].e && (db(f.els.er.e103), $.className = $.className + " " + aa(f.invalidColor)));
                    kb = null;
                }
            } else Mb = !0;
        }, Vb = function() { $a || (Ja = !1, jc.value = Pa.serialize(qb())); }, qb = function() {
            var c = za(), b, a, l, m = !1, k = new d.Models.RuleModel;
            k.Elements = [];
            g(da) && (k.Id = da);
            k.IsLoadedRuleOfEvalType = f.isEval;
            k.Command =
                Qa;
            if (!Ja) {
                f.tools ? (b = Y.getValue(), k.Name = 0 == d.trim(b).length || d.trim(b).toLowerCase() == f.els.lbl.n.toLowerCase() || d.trim(b).toLowerCase() == f.els.er.e104.toLowerCase() ? null : Ma(b), b = qa.getValue(), k.Desc = 0 == d.trim(b).length || d.trim(b).toLowerCase() == f.els.lbl.d.toLowerCase() || d.trim(b).toLowerCase() == f.els.er.e104.toLowerCase() ? null : Ma(b), k.SkipNameValidation = !1) : k.SkipNameValidation = !0;
                for (var n in c)
                    if (a = c[n], l = r(a), g(l) && l != elementType.HtmlTag) {
                        b = new d.Client.Element;
                        b.Type = l;
                        b.Name = a.id;
                        b.Oper = ca(a);
                        b.FuncType =
                            M(a);
                        b.InpType = ga(a);
                        switch (l) {
                        case elementType.Field:
                            b.Value = a.getAttribute(H);
                            b.IsRule = "true" == a.getAttribute("ce213");
                            a = z(f.els.fds, b.Value);
                            m = g(a) && g(a.mds);
                            switch (b.Oper) {
                            case operatorType.String:
                                a = z(f.els.fds, b.Value);
                                g(a) && (b.Max = a.max);
                                break;
                            case operatorType.Numeric:
                                a = z(f.els.fds, b.Value);
                                g(a) && (b.Dec = a.dec, b.Cal = a.cal, b.Min = a.min, b.Max = a.max, g(a.mds) && (b.InpType = inputType.Input, m = !0));
                                break;
                            case operatorType.Date:
                            case operatorType.Time:
                                a = z(f.els.fds, b.Value);
                                g(a) && (b.Format = a.f);
                                break;
                            case operatorType.Enum:
                                a = z(f.els.fds, b.Value), g(a) && (b.En = a.e);
                            }
                            break;
                        case elementType.Value:
                            b.Value =
                                Ma(a.getAttribute(S));
                            b.Oper == operatorType.Numeric && m && (a = z(f.els.fds, b.Value), g(a) || (b.InpType = inputType.Input));
                            m = !1;
                            break;
                        case elementType.Calculation:
                            b.CalType = V(a);
                            g(a.getAttribute(S)) && (b.Value = a.getAttribute(S));
                            break;
                        case elementType.Action:
                        case elementType.Function:
                            if (l == elementType.Function && b.FuncType == functionType.Name) b.Value = a.getAttribute(H), a = z(f.els.fds, b.Value), m = g(a) && g(a.rt.mds);
                            else if (b.FuncType == functionType.Param) {
                                var ea = a;
                                l = b.Oper;
                                var s = ba(ea), v = null;
                                g(s) && (ea = Ua(ea), v = 0 <= ea && s.ps.length >= ea && s.ps[ea].o == l ? s.ps[ea] : Ac(s, l, 0 > ea ? 0 : ea));
                                l = v;
                                if (b.InpType ==
                                    inputType.Input) {
                                    if (g(l))
                                        switch (b.Oper) {
                                        case operatorType.String:
                                            b.Max = l.max;
                                            break;
                                        case operatorType.Numeric:
                                            b.Dec = l.dec;
                                            b.Min = l.min;
                                            b.Max = l.max;
                                            break;
                                        case operatorType.Date:
                                        case operatorType.Time:
                                            b.Format = l.f;
                                            break;
                                        case operatorType.Enum:
                                            b.En = l.e;
                                        }
                                    g(a.getAttribute(S)) && (b.Value = Ma(a.getAttribute(S)));
                                } else b.Value = a.getAttribute(H), a = z(f.els.fds, b.Value), g(l) && (l.o == operatorType.Numeric && g(l.mds) && !g(a)) && (b.InpType = inputType.Input);
                            } else b.Value = a.getAttribute(H);
                            break;
                        default:
                            b.Value = a.getAttribute(H);
                        }
                        k.Elements.push(b);
                    }
            }
            return k;
        }, disposeInternal = function() {
            Ra();
            6 == n ? (ua.close(), n = 1) : 3 == n ?
                (T.hide(), n = 1) : 4 == n ? (ia.hide(), n = 1) : 0 == n && (n = 1, g(b) && g(b.getAttribute("ce207")) && la());
            Bc() || Cc();
            2 != n && f.help && db(f.els.ms.i102);
            Ub();
            w = E;
            if (g(b) && (b.className = b.className.replace(" " + f.currentBg, ""), ma(b))) {
                var c = tb(b, functionType.Name);
                g(c) && (c.className = c.className.replace(" " + f.currentBg, ""));
            }
        }, ub = function(c, p) {
            var a = z(c == elementType.Action ? f.els.acs : f.els.fds, p);
            O(a.t, null, a.v, 0 < a.ps.length ? a.n + "&nbsp;(" : a.n, a.t == elementType.Action ? null : a.rt.o, calculationType.None, functionType.Name, inputType.None);
            var l = b;
            O(a.t, null, a.v, 0 < a.ps.length ? ")" : "&nbsp;", a.t == elementType.Action ?
                null : a.rt.o, calculationType.None, functionType.End, inputType.None);
            0 < a.ps.length ? (b = x(l), Z() && Da(a)) : Z() && eb(a);
        }, Da = function(c) {
            var p = Ua(b);
            if (p >= c.ps.length - 1 && !L) {
                var a = Xb(b, functionType.End);
                g(a) && (b = x(a), eb(c));
            } else {
                p += 1;
                L && (p -= 1);
                c = c.ps[p];
                var l = [], d;
                v = null;
                switch (c.ai) {
                case valueInputType.All:
                case valueInputType.Fields:
                    a: {
                        var k = c.o, n = p, p = [], q = wa(b);
                        if (g(q)) {
                            d = z(f.els.fds, q.getAttribute(H));
                            g(d) || (d = z(f.els.acs, q.getAttribute(H)));
                            if (!g(d)) {
                                d = p;
                                break a;
                            }
                            d = d.ps[n];
                        }
                        if (g(d))
                            for (var r in f.els.fds)
                                if (n = f.els.fds[r], n.t == elementType.Field && !n.ir && n.o == k) {
                                    if (d.o == operatorType.Numeric) {
                                        if (d.l !=
                                            n.l || n.min < d.min || n.max > d.max || n.dec != d.dec || n.mds != d.mds) continue;
                                    } else if (d.o == operatorType.Enum) {
                                        if (d.e != n.e || d.l != n.l) continue;
                                    } else if (d.l != n.l) continue;
                                    p.push(n);
                                }
                        d = p;
                    }
                    if (0 < d.length) {
                        c.ai == valueInputType.All && J(Ea, g(c.mds) ? c.mds : c.o, Va(c.o, g(c.mds)), l);
                        for (a in d) J(d[a].v, c.o, d[a].n, l);
                        0 < w.length ? ha(l, b, Wa, null) : s(l, b, Wa, null);
                    } else g(c.mds) ? Yb(c.mds) : Wa(Ea, c.o);
                    break;
                case valueInputType.User:
                    g(c.mds) ? Yb(c.mds) : Wa(Ea, c.o);
                    break;
                default:
                    throw Error("CL58");
                }
            }
        }, Yb = function(c) {
            v = cb(c);
            var p = [];
            if (null != v && 0 < v.length) {
                for (var a in v)
                    J(v[a].ID,
                        c, v[a].Name, p);
                0 < w.length ? ha(p, b, Wa, null) : s(p, b, Wa, null);
            } else Wa(Ea, operatorType.Numeric);
        }, Wa = function(c, p) {
            function a(c, p) {
                var e;
                L ? (e = b, L = !1) : e = M(b) == functionType.Name ? b : b.nextSibling;
                e = Xa(e, p);
                g(e) ? ja(e) : Zb(c);
            }
            function e(c) {
                var p = null, a = c ? operatorType.Date : operatorType.Time;
                c = c ? "" : "1/1/2000 ";
                try {
                    var d = b;
                    if (M(d) != functionType.Param || ca(d) != a) d = Xa(d, a);
                    g(d) && (p = new Date(c + d.getAttribute(S)));
                    isNaN(p.getDate()) && (p = null);
                    return p;
                } catch(l) {
                    return null;
                }
            }
            var d = ba(b);
            if (c == Ea) {
                var r = Dc(p);
                if (g(r)) P = L, Yb(r.Name);
                else
                    switch (parseInt(p, 10)) {
                    case operatorType.Numeric:
                        P =
                            !1;
                        if (vb(Xa(g(b.nextSibling) ? b.nextSibling : b, operatorType.Numeric))) a(d, operatorType.Numeric), O(d.t, null, E, "[]", operatorType.Numeric, calculationType.None, functionType.Param, inputType.Input);
                        break;
                    case operatorType.String:
                        P = !1;
                        if (vb(Xa(g(b.nextSibling) ? b.nextSibling : b, operatorType.String))) a(d, operatorType.String), O(d.t, null, E, '""', operatorType.String, calculationType.None, functionType.Param, inputType.Input);
                        break;
                    case operatorType.Date:
                        ua.close();
                        n = 3;
                        T.show(b, Yc, $b(d, T.defaultFormat()), L, e(!0));
                        T.position();
                        break;
                    case operatorType.Time:
                        ua.close();
                        n = 4;
                        ia.show(b, Zc, $b(d, ia.defaultFormat()), L, e(!1));
                        ia.position();
                        break;
                    case operatorType.Enum:
                        r = Ua(b) + (L ? 0 : 1);
                        0 > r && (r = 0);
                        r <= d.ps.length -
                            1 && (v = eval(Ta(d.ps[r].e)), P = L);
                        s(v, b, $c, null);
                        break;
                    case operatorType.Bool:
                        P = L;
                        s(Ec(), b, ad, null);
                        break;
                    default:
                        throw Error("CL62");
                    }
            } else r = cb(p), g(r) ? (a(d, operatorType.Numeric), O(d.t, null, c, z(r, c).Name, operatorType.Numeric, calculationType.None, functionType.Param, inputType.Field)) : (r = z(f.els.fds, c), a(d, parseInt(p, 10)), O(d.t, null, r.v, r.n, r.o, calculationType.None, functionType.Param, inputType.Field)), v = null, b = x(b), Z() && Da(d);
        }, ad = function(c) { Fc(c, operatorType.Bool, sb(c)); }, $c = function(c) { Fc(c, operatorType.Enum, z(v, c).Name); }, Fc = function(c, p, a) {
            var e = Xa(L ? b : b.nextSibling, p), d = !1;
            g(e) && (ua.close(), ja(e), d = !0, L = !1);
            e = ba(b);
            d || Zb(e);
            O(e.t, null, c, a, p, calculationType.None, functionType.Param, inputType.Input);
            b.setAttribute(S, c);
            b = x(b);
            Z() && Da(e);
        }, Yc = function(c) {
            var p = ba(b);
            Gc(c, p, operatorType.Date, d.formatDate(new Date(c), $b(p, T.defaultFormat())), T);
        }, Zc = function(c, p) { Gc(c, ba(b), operatorType.Time, p, ia); }, Gc = function(c, p, a, d, f) {
            var h = Xa(L ? b : b.nextSibling, a), r = !1;
            g(h) && (ja(h), r = !0, L = !1);
            O(p.t, null, c, d, a, null, functionType.Param, inputType.Input);
            b = x(b);
            f.hide();
            n = 0;
            if (!r)
                switch (c = Ya(b.nextSibling), M(c)) {
                case functionType.Param:
                    c = b;
                    O(p.t, null, E, ",", p.t == elementType.Action ? null : p.rt.o, calculationType.None, functionType.Comma, inputType.None);
                    b = x(c);
                    break;
                case functionType.End:
                case functionType.Comma:
                    c = b, a = Aa(b.previousSibling), M(a) == functionType.Param && 1 < ba(b).ps.length && (b = a, O(p.t, null, E, ",", p.t == elementType.Action ? null : p.rt.o, calculationType.None, functionType.Comma, inputType.None), b = x(c));
                }
            P = !1;
            Q();
            Z() && Da(p);
        }, Zb = function(c) {
            var p = Ya(b.nextSibling), a;
            switch (M(p)) {
            case functionType.Comma:
                b = p;
                Zb(c);
                break;
            case functionType.Param:
                O(c.t, null, E, ",", c.t == elementType.Action ? null : c.rt.o, calculationType.None, functionType.Comma, inputType.None);
                b = x(b.previousSibling);
                break;
            case functionType.End:
                p = M(b) != functionType.None ? null : b, a = Aa(b), M(a) == functionType.Param && 1 < ba(b).ps.length && (b = x(a), O(c.t, null, E, ",", c.t == elementType.Action ? null : c.rt.o,
                    calculationType.None, functionType.Comma, inputType.None), g(p) && (b = x(p)));
            }
        }, Ua = function(c) {
            for (var b = -1; g(c) && M(c) != functionType.Name;) M(c) == functionType.Param && b++, c = c.previousSibling;
            return b;
        }, eb = function(c) { g(c) && Z() && (c.t == elementType.Function ? s(Na(c), b, Ga, null) : (c = ac(), 0 < c.length && s(c, b, bc, null))); }, ba = function(c) {
            c = tb(c, functionType.Name);
            return !g(c) ? null : z(r(c) == elementType.Action ? f.els.acs : f.els.fds, c.getAttribute(H));
        }, Ac = function(c, b, a) {
            for (var e = a; e <= c.ps.length; e++) if (c.ps[e].o == b) return c.ps[e];
            return 0 < a ? Ac(c, b, 0) : null;
        }, sc = function(c, b) {
            var a, e, f;
            for (f in c)
                if (a = c[f], !g(a.Client) ||
                    !a.Client) {
                    e = new d.StringBuilder;
                    b ? g(a.Ns) && 0 < a.Ns.length && (CodeEffects.register(a.Ns), e.append(a.Ns), e.append(".")) : e.append("CodeEffects.Rule.");
                    e.append(Ta(a.Name));
                    e.append(" = [");
                    for (var h = 0; h < a.Data.length; h++) 0 < h && e.append(","), e.append('{"ID":"'), e.append(a.Data[h].ID), e.append('","Name":"'), e.append(a.Data[h].Name), e.append('"}');
                    e.append("]");
                    eval(e.dump());
                }
        }, bd = function(c) {
            G = !0;
            L = P = fa = !1;
            if (1 == n || 2 == n) return !0;
            var p = c.keyCode;
            if (16 == p) return !0;
            if (127 == p || 27 == p || 8 == p) G = !1;
            32 == p && 0 < w.length &&
                (w += " ");
            (6 == n || 8 == n) && 40 == p && Jb++;
            if ((6 == n || 8 == n) && 37 != p && 39 != p && (38 != p || 0 < Jb)) return !0;
            if (4 == n || 3 == n) {
                if (13 == p) return !0;
                4 == n ? ia.hide() : T.hide();
                n = 0;
            }
            var a = r(b), d = ca(b);
            switch (p) {
            case 9:
                w = E;
                (a == elementType.NewLine || a == elementType.Tab) && O(elementType.Tab, null, E, "&nbsp;", null, null, null, null);
                G = !1;
                break;
            case 13:
                if (!ya || ya && X)
                    if (w = E, a == elementType.Value) (d == operatorType.String || d == operatorType.Numeric) && g(b.getAttribute("ce207")) ? (la(), b = x(b), Q(), Z() && s(W(), b, U, elementType.RightParenthesis)) : Sa(!1);
                    else if (a == elementType.Calculation && V(b) == calculationType.Number)
                        g(b.getAttribute("ce207")) ? (la(),
                        b = x(b), Q(), Z() && s(Ba(), b, na, null)) : Sa(!1);
                    else if (a == elementType.Function || a == elementType.Action) (d == operatorType.String || d == operatorType.Numeric) && g(b.getAttribute("ce207")) ? (la(), b = x(b), Q(), Da(ba(b))) : ma(b) ? (Ca(b), Sa(!1)) : M(b) == functionType.End && Sa(!1);
                    else if (wb(b)) {
                        if (g(b.nextSibling) && M(b.nextSibling) == functionType.End && 0 == ba(b).ps.length) {
                            var m = cc(b);
                            g(m) && (b = m);
                        }
                        Sa(!1);
                    }
                X || (X = !0);
                G = !1;
                break;
            case 34:
                ka = 0;
                la();
                m = za();
                b = x(m[m.length - 1]);
                m = pa(b);
                dc(m.y, m.height);
                ma(b) && Ca(b);
                Q();
                G = !1;
                break;
            case 35:
                ka = 0;
                la();
                m = xb(b, elementType.HtmlTag);
                g(m) ? b = x(m.previousSibling) : (m = za(),
                b = x(m[m.length - 1]));
                ma(b) && Ca(b);
                Q();
                G = !1;
                break;
            case 33:
                ka = 0;
                la();
                b = x(za()[0]);
                yb(pa(b).y);
                Q();
                G = !1;
                break;
            case 36:
                ka = 0;
                la();
                m = ec(b, elementType.NewLine);
                if (!g(m) && (m = za()[0], "if" != m.getAttribute(H))) throw Error("CL02");
                b = x(m);
                Q();
                G = !1;
                break;
            case 38:
                (6 == n || 8 == n) && ra();
                va(a, d, V(b), ga(b)) && g(b.getAttribute("ce207")) && (la(), b = x(b));
                var a = za(), d = pa(b), v = null, u = 0;
                0 == ka && (ka = d.x + d.width);
                for (var ea = !1, t = a.length - 1; -1 < t; t--)
                    if (ea) {
                        u = r(a[t]);
                        if (g(v) && (u == elementType.NewLine || fb(a[t]))) {
                            b = x(a[t]);
                            yb(m.y);
                            break;
                        }
                        m = pa(a[t]);
                        if (!(m.y >
                            d.y - parseInt(m.height / 2, 10)))
                            if (g(v) || (v = a[t]), ka > m.x + m.width || !g(a[t].previousSibling) || pa(a[t].previousSibling).y < m.y) {
                                b = x(a[t]);
                                yb(m.y);
                                break;
                            } else if (u = m.x + parseInt(m.width / 2, 10), ka > u) {
                                yb(m.y);
                                b = x(a[t]);
                                break;
                            }
                    } else ea = a[t].id == b.id;
                ma(b) && Ca(b);
                Q();
                G = !1;
                break;
            case 40:
                va(a, d, V(b), ga(b)) && g(b.getAttribute("ce207")) && (la(), b = x(b));
                m = za();
                a = pa(b);
                v = null;
                0 == ka && (ka = a.x + a.width);
                ea = !1;
                for (t = m.length - 1; -1 < t && m[t].id != b.id; t--)
                    if (d = pa(m[t]), ea || (ea = d.y - a.height - parseInt(a.height / 2, 10) < a.y), ea)
                        if (ka > d.x +
                            d.width || !g(pa(m[t].previousSibling)) || pa(m[t].previousSibling).y < d.y) {
                            b = x(m[t]);
                            dc(d.y, d.height);
                            break;
                        } else if (v = d.x + parseInt(d.width / 2, 10), ka >= v) {
                            b = x(m[t]);
                            dc(d.y, d.height);
                            break;
                        }
                ma(b) && Ca(b);
                Q();
                G = !1;
                break;
            case 37:
                ka = 0;
                (6 == n || 8 == n) && ra();
                va(a, d, V(b), ga(b)) && ga(b) != inputType.Field ? (g(b.getAttribute("ce207")) ? (la(), b = x(b.previousSibling), ma(b) && Ca(b)) : b.setAttribute("ce207", "true"), Q()) : g(b.previousSibling) && (m = r(b.previousSibling), b = x(m == elementType.HtmlTag ? b.previousSibling.previousSibling : b.previousSibling), ma(b) &&
                    (M(b) == functionType.End ? Ca(b) : b = x(b.previousSibling)), Q());
                G = !1;
                break;
            case 39:
                ka = 0;
                (6 == n || 8 == n) && ra();
                if (a == elementType.Value && (d == operatorType.String || d == operatorType.Numeric) && g(b.getAttribute("ce207"))) la(), b = x(b), Q(), Z() && s(W(), b, U, elementType.RightParenthesis);
                else if (a == elementType.Calculation && V(b) == calculationType.Number && g(b.getAttribute("ce207"))) la(), b = x(b), Q(), Z() && s(Ba(), b, na, null);
                else if ((a == elementType.Function || a == elementType.Action) && ga(b) == inputType.Input && (d == operatorType.String || d == operatorType.Numeric) && g(b.getAttribute("ce207"))) la(), b = x(b), Q();
                else if (g(b.nextSibling) && ma(b.nextSibling))
                    Ca(b.nextSibling),
                    Q(), eb(ba(b));
                else if (m = !1, g(b.nextSibling) && (b = r(b.nextSibling) == elementType.HtmlTag ? x(b.nextSibling.nextSibling) : x(b.nextSibling), m = !0), m) {
                    a = r(b);
                    m = Z();
                    if (va(a, ca(b), V(b), ga(b)) && ga(b) != inputType.Field) b.setAttribute("ce207", "true"), Q();
                    else if (!g(b.nextSibling) && a == elementType.RightBracket) s(W(), b, U, elementType.RightParenthesis);
                    else if ((a == elementType.Function || a == elementType.Action) && m)
                        switch (M(b)) {
                        case functionType.End:
                            eb(ba(b));
                            break;
                        case functionType.Name:
                            m = ba(b), 0 < m.ps.length && M(b.nextSibling) == functionType.End && Da(m);
                        }
                    else
                        a == elementType.Flow && m ? "else" == b.getAttribute(H) ? s(f.els.acs, b, Ha,
                            null) : s(sa(), b, ta, elementType.LeftParenthesis) : a == elementType.LeftParenthesis && m ? s(sa(), b, ta, elementType.LeftParenthesis) : a == elementType.RightParenthesis && m ? s(W(), b, U, elementType.RightParenthesis) : a == elementType.Field && m ? (m = Na(z(f.els.fds, b.getAttribute(H))), s(m, b, Ga, null)) : a == elementType.Operator && m ? "isNull" == b.getAttribute(H) || "isNotNull" == b.getAttribute(H) ? s(W(), b, U, elementType.RightParenthesis) : gb(b, !0) : a == elementType.Clause && m ? "then" == b.getAttribute(H) ? s(f.els.acs, b, Ha, null) : s(sa(), b, ta, elementType.LeftParenthesis) : a == elementType.RightBracket && m ? s(W(), b, U, elementType.RightParenthesis) : a == elementType.LeftBracket && m ? s(Ba(),
                                b, na, null) : a == elementType.Calculation && m ? s(Ba(), b, na, null) : a == elementType.Value && m && s(W(), b, U, elementType.RightParenthesis);
                    bb();
                }
                G = !1;
            }
            if (jb) return 8 == p && c.preventDefault(), !1;
            if (ya && 13 == p || 8 == p || 9 == p || 33 == p || 34 == p || 35 == p || 36 == p || 38 == p || 39 == p || 40 == p) c.preventDefault && c.preventDefault(), c.stopPropagation && c.stopPropagation();
            return G;
        }, cd = function(c) {
            var a = c.keyCode;
            if (!G) return G = !0, jb ? ((9 == a || 13 == a || 33 == a || 34 == a || 35 == a || 36 == a || 38 == a || 40 == a) && c.preventDefault(), !1) : !0;
            if (1 == n || 2 == n) return !0;
            if ((6 == n || 8 == n) && !oa(a) || (6 == n || 8 == n) &&
                38 == a) return !1;
            if (3 != n && 4 != n) {
                ya || c.preventDefault();
                var d = w;
                w = E;
                if (8 == n) 32 == a ? (P = !0, s(N, I, zb, null), n = 8) : oa(a) && (w = d += String.fromCharCode(a), P = !0, ha(N, I, zb, null), n = 8);
                else {
                    var l = Aa(b);
                    switch (r(l)) {
                    case elementType.Flow:
                        "else" == l.getAttribute(H) ? 32 == a ? s(f.els.acs, b, Ha, null) : oa(a) && (w = d += String.fromCharCode(a), ha(f.els.acs, b, Ha, null)) : 32 == a ? s(sa(), b, ta, elementType.LeftParenthesis) : oa(a) && (w = d += String.fromCharCode(a), ha(sa(), b, ta, elementType.LeftParenthesis));
                        break;
                    case elementType.Function:
                    case elementType.Action:
                        if (fc(a))
                            switch (M(l)) {
                            case functionType.End:
                                if (32 ==
                                    a) eb(ba(l));
                                else if (oa(a) && (d = ba(l), Z() && (l = d.t == elementType.Function ? Na(d) : ac(), 0 < l.length))) {
                                    var d = d.t == elementType.Function ? Ga : bc, m = Hc(l, w);
                                    0 < m.length ? s(m, b, d, null, !0) : s(l, b, d, null, !1);
                                }
                                break;
                            default:
                                if (m = ca(l), va(r(l), m, V(l), ga(l)) && (m == operatorType.String || m == operatorType.Numeric && (43 < a && 47 > a || 47 < a && 58 > a)) && g(l.getAttribute("ce207"))) {
                                    var d = Ua(l), d = 0 > d ? 0 : d, q = ba(l);
                                    Ab(l, a, m, q.ps[d].max, g(q.ps[d].min) ? q.ps[d].min : null, q.ps[d].dec);
                                } else 32 == a ? Da(ba(l)) : oa(a) && (w = d += String.fromCharCode(a), Da(ba(l)));
                            }
                        break;
                    case elementType.LeftParenthesis:
                        32 == a ? s(sa(),
                            b, ta, elementType.LeftParenthesis) : oa(a) && (w = d += String.fromCharCode(a), ha(sa(), b, ta, elementType.LeftParenthesis));
                        break;
                    case elementType.RightParenthesis:
                        32 == a ? s(W(), b, U, elementType.RightParenthesis) : oa(a) && (w = d += String.fromCharCode(a), ha(W(), b, U, elementType.RightParenthesis));
                        break;
                    case elementType.Field:
                        l = z(f.els.fds, l.getAttribute(H));
                        l = Na(l);
                        32 == a ? s(l, b, Ga, null) : oa(a) && (w = d += String.fromCharCode(a), ha(l, b, Ga, null));
                        break;
                    case elementType.Operator:
                        32 == a ? "isNull" == l.getAttribute(H) || "isNotNull" == l.getAttribute(H) ? s(W(), l, U, elementType.RightParenthesis) : gb(l) : oa(a) && (w = d += String.fromCharCode(a),
                        "isNull" == l.getAttribute(H) || "isNotNull" == l.getAttribute(H) ? ha(W(), b, U, elementType.RightParenthesis) : 0 < C.length ? ha(C, b, Ib ? Ic : Jc, null) : gb(l));
                        break;
                    case elementType.Clause:
                        32 == a ? "then" == l.getAttribute(H) ? s(f.els.acs, b, Ha, null) : s(sa(), b, ta, elementType.LeftParenthesis) : oa(a) && (l = "then" == l.getAttribute(H), w = d += String.fromCharCode(a), ha(l ? f.els.acs : sa(), b, l ? Ha : ta, l ? null : elementType.LeftParenthesis));
                        break;
                    case elementType.RightBracket:
                        32 == a ? s(W(), b, U, elementType.RightParenthesis) : oa(a) && (w = d += String.fromCharCode(a), ha(W(), b, U, elementType.RightParenthesis));
                        break;
                    case elementType.LeftBracket:
                        32 ==
                            a ? s(Ba(), b, na, null) : oa(a) && (w = d += String.fromCharCode(a), ha(Ba(), b, na, null));
                        break;
                    case elementType.Calculation:
                        if (V(l) == calculationType.Number) {
                            if (fc(a))
                                if (43 < a && 47 > a || 47 < a && 58 > a) {
                                    if (g(l.getAttribute("ce207")) && (d = Ka(l), d = 3 > d.length ? E : d.substr(1, d.length - 2), 28 > d.length && (45 != a || 1 > d.length))) {
                                        if (44 == a || 46 == a) d = d.replace(/[\.,]+/g, E);
                                        d += String.fromCharCode(a);
                                        if ("," == d || "." == d) d = "0" + d;
                                        if ("-," == d || "-." == d) d = "-0" + d.substr(1, 1);
                                        1 < d.length && ("0" == d.substr(0, 1) && "," != d.substr(1, 1) && "." != d.substr(1, 1)) && (d = d.substr(1));
                                        2 < d.length &&
                                            ("-0" == d.substr(0, 2) && "," != d.substr(2, 1) && "." != d.substr(2, 1)) && (d = "-" + d.substr(2));
                                        Ka(l, "[" + d + "]");
                                        l.setAttribute(S, d);
                                        b = l;
                                        Q();
                                    }
                                } else 32 == a ? s(Ba(), b, na, null) : oa(a) && (w = d += String.fromCharCode(a), ha(Ba(), b, na, null));
                        } else 32 == a ? s(Ba(), b, na, null) : oa(a) && (w = d += String.fromCharCode(a), ha(Ba(), b, na, null));
                        break;
                    case elementType.Value:
                        if (fc(a))
                            if (m = ca(l), m == operatorType.String || m == operatorType.Numeric && (43 < a && 47 > a || 47 < a && 58 > a))
                                g(l.getAttribute("ce207")) ? (d = wa(l), d = g(d) ? z(f.els.fds, d.getAttribute(H)) : null, g(d) ? d.t == elementType.Function ? Ab(l, a, m, d.rt.max,
                                    g(d.rt.min) ? d.rt.min : null, d.rt.dec) : Ab(l, a, m, d.max, g(d.min) ? d.min : null, d.dec) : Ab(l, a, m, null, null, null)) : 32 == a ? s(W(), b, U, elementType.RightParenthesis) : oa(a) && (w = d += String.fromCharCode(a), ha(W(), b, U, elementType.RightParenthesis));
                            else if (m == operatorType.Numeric && 32 == a) g(l.getAttribute("ce207")) || s(W(), b, U, elementType.RightParenthesis);
                            else if (m == operatorType.Date || m == operatorType.Time || m == operatorType.Bool || m == operatorType.Enum) 32 == a ? s(W(), b, U, elementType.RightParenthesis) : oa(a) && (w = d += String.fromCharCode(a), ha(W(), b, U, elementType.RightParenthesis));
                    }
                }
            }
            if (jb)
                return (8 == a || 9 == a || 32 == a || 33 == a || 34 == a || 35 ==
                    a || 36 == a || 38 == a || 40 == a) && c.preventDefault(), !1;
            if (8 == a || 9 == a || 32 == a) c.preventDefault && c.preventDefault(), c.stopPropagation && c.stopPropagation();
        }, fc = function(c) {
            switch (c) {
            case 8:
            case 9:
            case 16:
            case 17:
            case 18:
            case 19:
            case 20:
            case 27:
            case 127:
                return !1;
            default:
                return !0;
            }
        }, Ab = function(c, a, e, d, m, j) {
            var k = Ka(c), k = 3 > k.length ? E : k.substr(1, k.length - 2), n = g(d) ? d : 256, q = g(j) ? j : !0, r = g(m) ? 0 > m : !0;
            if (e == operatorType.String && k.length < n) {
                var s;
                if (22 == a)
                    if (ya)
                        try {
                            s = window.clipboardData.getData("Text").replace(/[\s]+/g, " "), k.length +
                                s.length > n && (s = s.substr(0, n - k.length));
                        } catch(v) {
                        }
                    else f.help && g(f.els.er.e101) && alert(f.els.er.e101);
                else s = String.fromCharCode(a), 0 == k.length && (s = s.replace(/[\s]+/g, E));
                d = k + s;
                Ka(c, '"' + d + '"');
                c.setAttribute(S, d);
            } else if (e == operatorType.Numeric && 28 > k.length && (q || 44 != a && 46 != a) && (r && 1 > k.length || 45 != a)) {
                if (j && (44 == a || 46 == a)) k = k.replace(/[\.,]+/g, E);
                a = k + String.fromCharCode(a);
                if ("," == a || "." == a) a = "0" + a;
                if ("-," == a || "-." == a) a = "-0" + a.substr(1, 1);
                1 < a.length && ("0" == a.substr(0, 1) && "," != a.substr(1, 1) && "." != a.substr(1, 1)) &&
                    (a = a.substr(1));
                2 < a.length && ("-0" == a.substr(0, 2) && "," != a.substr(2, 1) && "." != a.substr(2, 1)) && (a = "-" + a.substr(2));
                e = parseFloat(a.replace(",", "."));
                m = g(m) ? m : -9007199254740992;
                d = g(d) ? d : 9007199254740992;
                e > d && (0 <= d ? a = d + E : (parseInt(e, 10) + E).length >= (parseInt(m, 10) + E).length && (a = d + E));
                Ka(c, "[" + a + "]");
                c.setAttribute(S, a);
                c.setAttribute("ce212", d.toString());
                c.setAttribute("ce211", m.toString());
            }
            b = c;
            Q();
        }, s = function(c, a, h, l, m) {
            ua.close();
            var j = [], k;
            if (g(l)) {
                var q = xb(b, elementType.Flow);
                g(q) ? q = q.previousSibling : (q = za(),
                q = q[q.length - 1]);
                for (var s = 0, v = 0; g(q) && r(q) != elementType.Flow;) r(q) == elementType.LeftParenthesis && s++, r(q) == elementType.RightParenthesis && v++, q = g(q.previousSibling) && r(q.previousSibling) != elementType.Flow ? q.previousSibling : null;
                if (l == elementType.RightParenthesis && s > v) {
                    if (l = new d.Menu.Item, l.Name = ")", l.Type = elementType.RightParenthesis, j.push(l), c[0].t == elementType.Clause) {
                        l = [];
                        for (k in c) "then" != c[k].v && l.push(c[k]);
                        c = l;
                    }
                } else l == elementType.LeftParenthesis && (l = new d.Menu.Item, l.Name = "(", l.Type = elementType.LeftParenthesis, j.push(l));
            }
            for (var t in c) {
                k = c[t];
                l = new d.Menu.Item;
                l.ID = k.v || k.ID;
                l.Name = k.n || k.Name;
                if (g(k.t) || g(k.Type)) l.Type = k.t || k.Type;
                j.push(l);
            }
            ua.fill(a, j, h, ya && 9 > d.Client.version ? dd : null, ed, f.help ? fd : null);
            P && ua.alignLeft(a);
            P = !1;
            n = 6;
            m || (w = E);
        }, ha = function(c, b, a, e) {
            c = Hc(c, w);
            if (0 < c.length) {
                var d = w;
                s(c, b, a, e, !0);
                ua.select(d);
            } else ra();
        }, gb = function(c, a) {
            function d(c, a) {
                if (c == Ea)
                    switch (parseInt(a, 10)) {
                    case operatorType.Numeric:
                        O(elementType.Value, null, E, "[]", operatorType.Numeric, null, null, null);
                        break;
                    default:
                        Bb(Aa(b));
                    }
                else if (c == mb) Kc(c);
                else {
                    var p = z(f.els.fds, c);
                    O(elementType.Value, null, p.v, p.n, p.o, null, null, inputType.Field);
                    b.setAttribute(S, c);
                    Z() && s(W(), b, U, elementType.RightParenthesis);
                }
            }
            function l(c) {
                O(elementType.Value, null, c, z(v, c).Name, operatorType.Numeric, null, null, inputType.Field);
                v = null;
                b.setAttribute(S, c);
                Z() && s(W(), b, U, elementType.RightParenthesis);
            }
            function m(c) {
                if (c == Ea) {
                    c = j();
                    var b = null;
                    c.t == elementType.Function ? g(c.rt.mds) && (b = c.rt.mds) : g(c.mds) && (b = c.mds);
                    k(b);
                } else d(c);
            }
            function k(c) {
                v = cb(c);
                null != v && (P = L, s(v, b, l, null));
            }
            function j() {
                var c = wa(b);
                return !g(c) ? null : z(f.els.fds, c.getAttribute(H));
            }
            var n = j();
            if (g(n)) {
                var r = n.t == elementType.Function ? n.rt.ai : n.ai, t = n.t == elementType.Function ?
                    n.rt.o : n.o, x = null;
                n.t == elementType.Function ? g(n.rt.mds) && (x = n.rt.mds) : g(n.mds) && (x = n.mds);
                if (g(x)) {
                    var A = Lc(t, n);
                    if (r == valueInputType.User || 0 == A.length || 1 == A.length && A[0].v == n.v) k(x);
                    else {
                        var D = [];
                        if (0 < A.length) {
                            r == valueInputType.All && J(Ea, t, Va(t, !0), D);
                            for (var B in A) r = A[B], r.v != n.v && J(r.v, r.o, r.n, D);
                            0 < w.length ? ha(D, b, m, null) : s(D, b, m, null);
                        } else k(x);
                    }
                } else if (r == valueInputType.User) (!a || t == operatorType.Enum || t == operatorType.Bool) && Bb(c);
                else if (B = [], x = Lc(t, n), 0 < x.length)
                    if (1 == x.length && x[0].v == n.v) Bb(c);
                    else {
                        (t == operatorType.Numeric && n.t == elementType.Function ? n.rt.cal : n.cal) && J(mb, t, f.els.lbl.c,
                            B);
                        r == valueInputType.All && J(Ea, t, Va(t), B);
                        for (A in x) r = x[A], r.v != n.v && J(r.v, r.o, r.n, B);
                        0 < w.length ? ha(B, b, d, null) : s(B, b, d, null);
                    }
                else a || Bb(c);
            }
        }, Bb = function(c) {
            function a(c) {
                var d = null;
                try {
                    var p = b;
                    c = c ? "" : "1/1/2000 ";
                    r(p) != elementType.Value && (p = xb(p, elementType.Value));
                    g(p) && (d = new Date(c + p.getAttribute(S)));
                    isNaN(d.getDate()) && (d = null);
                } catch(f) {
                    d = null;
                }
                return d;
            }
            ra();
            switch (ca(c)) {
            case operatorType.String:
                vb(b.nextSibling) && O(elementType.Value, null, E, '""', operatorType.String, null, null, null);
                break;
            case operatorType.Date:
                n = 3;
                c = wa(b);
                c = g(c) ? z(f.els.fds, c.getAttribute(H)) : null;
                c =
                    !g(c) ? T.defaultFormat() : g(c.rt) ? c.rt.f : c.f;
                T.show(b, gd, c, L, a(!0));
                T.position();
                break;
            case operatorType.Time:
                n = 4;
                c = wa(b);
                c = g(c) ? z(f.els.fds, c.getAttribute(H)) : null;
                c = !g(c) ? ia.defaultFormat() : g(c.rt) ? c.rt.f : c.f;
                ia.show(b, hd, c, L, a(!1));
                ia.position();
                break;
            case operatorType.Enum:
                c = wa(c);
                g(c) && (r(c) == elementType.Function ? (c = ba(c), v = eval(Ta(c.rt.e))) : (c = z(f.els.fds, c.getAttribute(H)), v = g(c.e) ? eval(Ta(c.e)) : c.ens), C = v, Ib = !1, P = L, s(v, b, Jc, null));
                break;
            case operatorType.Bool:
                C = Ec();
                Ib = !0;
                P = L;
                s(C, b, Ic, null);
                break;
            default:
                c = wa(b), c = g(c) ? z(f.els.fds, c.getAttribute(H)) :
                    null, g(c) && (c.cal || g(c.rt) && c.rt.cal) ? (c = [], J(mb, null, f.els.lbl.c, c), J(Ea, null, Va(operatorType.Numeric), c), s(c, b, Kc, null)) : vb(b.nextSibling) && O(elementType.Value, null, E, "[]", operatorType.Numeric, null, null, null);
            }
        }, Ga = function(c) {
            var a = Aa(b), d = ca(a);
            hb(zc(c, d), null);
            Z() ? "isNull" == c || "isNotNull" == c ? s(W(), b, U, elementType.RightParenthesis) : gb(a) : G = !1;
        }, Kc = function(c) {
            switch (c) {
            case mb:
                O(elementType.LeftBracket, null, E, "{", null, null, null, null);
                c = b;
                O(elementType.RightBracket, null, E, "}", null, null, null, null);
                b = x(c);
                Q();
                s(Ba(), b, na, null);
                break;
            default:
                O(elementType.Value, null, E,
                    "[]", operatorType.Numeric, null, null, null);
            }
        }, na = function(c, a) {
            c = parseInt(c, 10);
            if (c == calculationType.Number) O(elementType.Calculation, null, E, "[]", operatorType.Numeric, c, null, null), b.setAttribute("ce207", "true"), Q();
            else {
                var d = E, l;
                switch (c) {
                case calculationType.Field:
                    l = z(f.els.fds, a);
                    if (!g(l)) throw Error("CL48");
                    d = l.v;
                    l = l.n;
                    break;
                case calculationType.LeftParenthesis:
                    l = "(";
                    break;
                case calculationType.RightParenthesis:
                    l = ")";
                    break;
                case calculationType.Multiplication:
                    l = "&#215;";
                    break;
                case calculationType.Division:
                    l = "&#247;";
                    break;
                case calculationType.Addition:
                    l = "+";
                    break;
                case calculationType.Subtraction:
                    l = "&#150;";
                    break;
                default:
                    throw Error("CL64");
                }
                O(elementType.Calculation, null, d, l, null, c, null, null);
                s(Ba(), b, na, null);
            }
        }, Ic = function(c) {
            O(elementType.Value, null, c, sb(c), operatorType.Bool, null, null, null);
            b.setAttribute(S, c);
            Z() && s(W(), b, U, elementType.RightParenthesis);
        }, Jc = function(c) {
            O(elementType.Value, null, c, z(v, c).Name, operatorType.Enum, null, null, null);
            v = null;
            b.setAttribute(S, c);
            Z() && s(W(), b, U, elementType.RightParenthesis);
        }, ta = function(c, a) {
            if (g(a) && parseInt(a, 10) == elementType.LeftParenthesis) O(elementType.LeftParenthesis, null, "(", "(", null, null, null, null), Z() && s(sa(), b, ta, elementType.LeftParenthesis);
            else {
                var d = z(f.els.fds, c);
                d.t == elementType.Function ?
                    ub(d.t, c) : (hb(d, null), Z() && s(Na(d), b, Ga, null));
            }
        }, U = function(c, a) { g(a) && parseInt(a, 10) == elementType.RightParenthesis ? (O(elementType.RightParenthesis, null, ")", ")", null, null, null, null), Z() && s(W(), b, U, elementType.RightParenthesis)) : (hb(z(f.els.cls, c), null), "then" == c && Z() ? s(f.els.acs, b, Ha, null) : Z() && s(sa(), b, ta, elementType.LeftParenthesis)); }, gd = function(c) {
            var a = wa(b), a = g(a) ? z(f.els.fds, a.getAttribute(H)) : null, a = !g(a) ? T.defaultFormat() : g(a.rt) ? a.rt.f : a.f, k = !0, l = Ya(b);
            g(l) && (r(l) == elementType.Value && ca(l) == operatorType.Date) && (b = x(l), k = !1);
            k ? O(elementType.Value, null, c, d.formatDate(new Date(c),
                a), operatorType.Date, null, null, null) : (b.setAttribute(S, c), d.text(b, d.formatDate(new Date(c), a)));
            T.hide();
            P = !1;
            n = 0;
            Q();
            Z() && s(W(), b, U, elementType.RightParenthesis);
        }, hd = function(c, a) {
            var f = !0;
            if (g(b.nextSibling)) {
                var l = Ya(b.nextSibling);
                g(l) && (r(l) == elementType.Value && ca(l) == operatorType.Time) && (b = x(l), f = !1);
            }
            f ? O(elementType.Value, null, c, a, operatorType.Time, null, null, null) : (b.setAttribute(S, c), d.text(b, a));
            ia.hide();
            P = !1;
            n = 0;
            Q();
            Z() && s(W(), b, U, elementType.RightParenthesis);
        }, Ha = function(c) { ub(z(f.els.acs, c).t, c); }, bc = function(c) {
            hb(z(f.els.fls, c), null);
            Z() && ("else" == c ? s(f.els.acs,
                b, Ha, null) : s(sa(), b, ta, elementType.LeftParenthesis));
        }, O = function(c, b, a, e, f, n, r, s, v) {
            var t = new d.Client.Element;
            t.n = e;
            t.v = a;
            t.t = c;
            t.o = g(f) ? f : operatorType.None;
            t.CalType = g(n) ? n : calculationType.None;
            t.FuncType = g(r) ? r : functionType.None;
            t.InpType = g(s) ? s : inputType.None;
            hb(t, b, v);
        }, hb = function(c, a, d) {
            var l, m;
            l = !(!g(b) || !g(b.nextSibling));
            m = document.createElement("SPAN");
            m.id = g(a) ? a : targetElement.id + Ia;
            Ia++;
            99999999999 < Ia && (Ia = 0);
            m.innerHTML = c.n;
            c.t == elementType.Value ? (xa(m, f.valueCss), g(m.getAttribute(S)) || m.setAttribute(S, c.v)) : c.t == elementType.Calculation ? (xa(m, f.calcCss), g(c.v) && m.setAttribute(S,
                c.v), c.CalType == calculationType.RightParenthesis ? (m.onmouseover = function() { Cb(this, Mc); }, m.onmouseout = function() { Db(this, Mc); }, m.style.paddingRight = m.style.paddingLeft = "2px") : c.CalType == calculationType.LeftParenthesis && (m.onmouseover = function() { Cb(this, Nc); }, m.onmouseout = function() { Db(this, Nc); }, m.style.paddingRight = m.style.paddingLeft = "2px")) : c.t == elementType.Flow ? xa(m, f.flowCss) : c.t == elementType.Field ? xa(m, f.fieldCss) : c.t == elementType.Function ? c.FuncType == functionType.Name || c.FuncType == functionType.End ? xa(m, f.fieldCss) : (xa(m, f.paramCss), c.InpType == inputType.Input && g(c.v) && m.setAttribute(S,
                    c.v)) : c.t == elementType.Action ? c.FuncType == functionType.Name || c.FuncType == functionType.End ? xa(m, f.actionCss) : (xa(m, f.paramCss), c.InpType == inputType.Input && g(c.v) && m.setAttribute(S, c.v)) : c.t == elementType.Operator ? xa(m, f.operCss) : c.t == elementType.LeftBracket || c.t == elementType.RightBracket ? xa(m, f.skobkiCss) : c.t == elementType.Clause ? xa(m, f.clauseCss) : c.t == elementType.Tab ? xa(m, f.tabCss) : c.t == elementType.NewLine && xa(m, f.lineCss);
            if (c.t == elementType.Tab) m.style.paddingRight = m.style.paddingLeft = "8px";
            else if ((c.t == elementType.Function || c.t == elementType.Action) && c.FuncType == functionType.End) {
                if (a = z(c.t == elementType.Function ? f.els.fds : f.els.acs, c.v), !g(a) ||
                    !g(a.ps) || 0 == a.ps.length) m.style.paddingRight = m.style.paddingLeft = "0px", m.style.width = "2px";
            } else c.t == elementType.RightParenthesis ? (m.onmouseover = function() { Cb(this, Oc); }, m.onmouseout = function() { Db(this, Oc); }, g(f.skobkiCss) && 0 < f.skobkiCss.length && (m.className = aa(f.skobkiCss))) : c.t == elementType.LeftParenthesis && (m.onmouseover = function() { Cb(this, Pc); }, m.onmouseout = function() { Db(this, Pc); }, g(f.skobkiCss) && 0 < f.skobkiCss.length && (m.className = aa(f.skobkiCss))), m.style.paddingRight = m.style.paddingLeft = "2px";
            m.style.paddingBottom =
                "2px";
            m.style.marginTop = m.style.marginLeft = m.style.marginRight = m.style.marginBottom = "0px";
            m.style.display = "inline-block";
            m.style.whiteSpace = "nowrap";
            if (c.CalType == calculationType.Number || (c.t == elementType.Value || c.FuncType == functionType.Param) && c.InpType != inputType.Field && (c.o == operatorType.String || c.o == operatorType.Numeric)) m.style.cursor = "text";
            m.setAttribute("ce202", c.t);
            c.t == elementType.Field && c.o == operatorType.Bool && (c.ir ? m.setAttribute("ce213", "true") : (a = z(f.els.fds, c.v), g(a) && (g(a.ir) && a.ir) && m.setAttribute("ce213", "true")));
            m.setAttribute("ce203", g(c.CalType) ? c.CalType : calculationType.None);
            m.setAttribute("ce204", g(c.FuncType) ? c.FuncType : functionType.None);
            m.setAttribute("ce205", g(c.InpType) ? c.InpType : inputType.None);
            m.setAttribute(H, c.v);
            g(c.o) && c.o != operatorType.None ? (m.setAttribute("ce209", c.o), va(c.t, c.o, c.CalType, c.InpType) && c.InpType != inputType.Field && m.setAttribute("ce207", "true")) : m.setAttribute("ce209", operatorType.None);
            L && Oa();
            L = !1;
            if (l) {
                if (l = b.nextSibling, targetElement.insertBefore(m, b.nextSibling), c.t != elementType.Tab) {
                    if (g(l) && r(l) == elementType.Tab) for (; g(l) && r(l) == elementType.Tab;) a = l.nextSibling, targetElement.removeChild(l), l = a;
                    if (g(l)) {
                        if (c.t == elementType.RightBracket && r(l) == elementType.LeftBracket) {
                            for (; r(l) !=
                                elementType.RightBracket;) a = l.nextSibling, targetElement.removeChild(l), l = a;
                            targetElement.removeChild(l);
                        }
                        c.t == elementType.Calculation && (c.CalType == calculationType.Field || c.CalType == calculationType.Number) ? c.t == r(l) && id(c.CalType, V(l)) && targetElement.removeChild(l) : (c.t == elementType.Value || c.t == elementType.Operator && "isNull" != c.v && "isNotNull" != c.v || c.t == elementType.Clause && "then" == c.v || c.t == elementType.Flow && "else" == c.v) && (c.t == r(l) && c.o == ca(l)) && targetElement.removeChild(l);
                    }
                }
            } else targetElement.appendChild(m);
            (c.t == elementType.Function || c.t == elementType.Action) && c.FuncType == functionType.End && ma(m) ? Ca(m, d) : b = d ? m : x(m);
            if (f.titles)
                switch (d = function(c) {
                    c = z(f.els.fds, c);
                    g(c) && g(c.d) &&
                        (b.title = Fa(c.d));
                }, c.t) {
                case elementType.Function:
                case elementType.Action:
                    switch (c.FuncType) {
                    case functionType.Name:
                        c = z(c.t == elementType.Function ? f.els.fds : f.els.acs, c.v);
                        g(c) && g(c.d) && (b.title = Fa(c.d));
                        break;
                    case functionType.Param:
                        c = ba(b), g(c) && 0 < c.ps.length && (d = Ua(b), 0 <= d && (c = c.ps[d], g(c) && g(c.d) && (b.title = Fa(c.d))));
                    }
                    break;
                case elementType.Field:
                    d(c.v);
                    break;
                case elementType.Value:
                    c.InpType == inputType.Field && d(c.v);
                    break;
                case elementType.Calculation:
                    c.CalType == calculationType.Field && d(c.v);
                }
            fa = !1;
            Q();
        }, Oa = function() {
            var c;
            r(b) == elementType.HtmlTag && (b = x(g(b.nextSibling) ? b.nextSibling : b.previousSibling));
            switch (r(b)) {
            case elementType.Function:
            case elementType.Action:
                switch (M(b)) {
                case functionType.Name:
                    for (; M(b) !=
                        functionType.End;) c = b.nextSibling, targetElement.removeChild(b), b = c;
                    ja(b);
                    break;
                case functionType.End:
                    for (; M(b) != functionType.Name;) ja(b);
                    ja(b);
                    break;
                case functionType.Comma:
                    for (ja(b); M(b) != functionType.Name && M(b) != functionType.Comma;) ja(b);
                    break;
                case functionType.Param:
                    c = Ya(b.nextSibling);
                    if (M(c) == functionType.Comma) b = c, Oa();
                    else for (ja(b); M(b) != functionType.Name && M(b) != functionType.Param;) ja(b);
                    break;
                default:
                    throw Error("CL89");
                }
                break;
            case elementType.LeftBracket:
                if (!g(b.nextSibling)) throw Error("CL82");
                for (; r(b) != elementType.RightBracket;) c = b.nextSibling, targetElement.removeChild(b), b = c;
                ja(b);
                break;
            case elementType.RightBracket:
                if (!g(b.previousSibling)) throw Error("CL84");
                for (; r(b) != elementType.LeftBracket;) ja(b);
                ja(b);
                break;
            default:
                ja(b);
            }
            Q();
        }, ja = function(c) {
            if (g(c.previousSibling)) {
                var a = c.previousSibling;
                targetElement.removeChild(c);
                b = x(a);
            }
        }, Cb = function(c, a) {
            if (!Eb(c)) {
                var e = a(c);
                if (g(e)) {
                    if (1 == n || c.id != b.id) c.className = c.className + " " + f.highlightBg;
                    if (!Eb(e) && (1 == n || e.id != b.id)) e.className = e.className + " " + f.highlightBg;
                }
            }
        }, Db = function(c, a) {
            if (!Eb(c)) {
                var e = a(c);
                if (g(e)) {
                    if (1 == n || c.id != b.id) c.className = c.className.replace(" " + f.highlightBg, "");
                    if (!Eb(e) && (1 == n || e.id != b.id))
                        e.className =
                            e.className.replace(" " + f.highlightBg, "");
                }
            }
        }, Eb = function(c) {
            if (!g(K) || 0 == K.length) return !1;
            for (var a in K) if (K[a] == c.id) return !0;
            return !1;
        }, Oc = function(c) {
            var a = 1;
            for (c = c.previousSibling; g(c) && !(r(c) == elementType.LeftParenthesis ? a-- : r(c) == elementType.RightParenthesis && a++, 0 == a);) c = c.previousSibling;
            return g(c) ? c : null;
        }, Pc = function(c) {
            var a = 1;
            for (c = c.nextSibling; g(c) && !(r(c) == elementType.RightParenthesis ? a-- : r(c) == elementType.LeftParenthesis && a++, 0 == a);) c = c.nextSibling;
            return g(c) ? c : null;
        }, Mc = function(c) {
            var a = 1;
            for (c = c.previousSibling; r(c) !=
                elementType.LeftBracket && !(V(c) == calculationType.LeftParenthesis ? a-- : V(c) == calculationType.RightParenthesis && a++, 0 == a);) c = c.previousSibling;
            return g(c) && r(c) != elementType.LeftBracket ? c : null;
        }, Nc = function(c) {
            var a = 1;
            for (c = c.nextSibling; r(c) != elementType.RightBracket && !(V(c) == calculationType.RightParenthesis ? a-- : V(c) == calculationType.LeftParenthesis && a++, 0 == a);) c = c.nextSibling;
            return g(c) && r(c) != elementType.RightBracket ? c : null;
        }, Sa = function(c, a) {
            if (!g(b.nextSibling) || !(r(b.nextSibling) == elementType.HtmlTag && g(b.nextSibling.nextSibling.nextSibling) && r(b.nextSibling.nextSibling.nextSibling) == elementType.HtmlTag)) {
                var d =
                    document.createElement("BR");
                d.setAttribute("ce202", elementType.HtmlTag);
                g(b) && g(b.nextSibling) || c ? targetElement.insertBefore(d, c ? b : b.nextSibling) : targetElement.appendChild(d);
                b = a ? d : x(d);
                O(elementType.NewLine, null, E, f.tochki ? "&#149;&nbsp;" : "&nbsp;&nbsp;", null, null, null, null, a);
            }
        }, Qc = function() { r(b) == elementType.NewLine || r(b.previousSibling) == elementType.NewLine ? (b = Aa(b.previousSibling), Fb(), b = x(g(b.nextSibling) ? b.nextSibling : b)) : fb(b.previousSibling) || (b = b.previousSibling, Oa(), b = x(g(b.nextSibling) ? b.nextSibling : b)); }, Cc = function() {
            wc();
            f.help && db(f.els.ms.i101);
            ka = 0;
            w = E;
            n = 2;
        }, oc = function() {
            if (g(targetElement)) {
                (6 == n || 8 == n) && ra();
                Cc();
                Ra();
                if (f.tools) {
                    Y.setValue(f.els.lbl.n);
                    Y.setClass(f.nameDefCss);
                    qa.setValue(f.els.lbl.d);
                    qa.setClass(f.descDefCss);
                    var c = document.getElementById("ceC" + targetElement.id);
                    c && c.parentNode.removeChild(c);
                }
                da = null;
                n = 1;
            }
        }, vb = function(c) { return g(c) && (c = Ya(c), g(c) && va(r(c), ca(c), V(c), ga(c)) && ga(c) != inputType.Field) ? (Rc(c), L = P = !1, Q(), !1) : !0; }, Ub = function() {
            if (0 < K.length) {
                var c, a;
                for (a in K)
                    c = document.getElementById(K[a]), g(c) && (c.className = c.className.replace(" " + f.highlightBg,
                        ""), c.title = E);
                K = [];
            }
            f.help && ($.className = $.className.replace(" " + f.invalidColor, ""));
        }, tc = function(c) {
            var a = "ceT" + targetElement.id;
            y = document.getElementById(a);
            g(y) && y.parentNode.removeChild(y);
            y = document.createElement("DIV");
            y.id = a;
            y.className = aa(f.toolCss);
            a = document.createElement("TABLE");
            a.cellPadding = a.cellSpacing = a.border = 0;
            a.style.width = "100%";
            var b = a.insertRow(-1), h = b.insertCell(-1);
            h.style.paddingRight = "6px";
            c ? uc(h) : (I = document.createElement("SPAN"), I.id = "ceRl" + targetElement.id, I.className = aa(f.rulesCss), I.innerHTML =
                f.els.lbl.r + "&nbsp;&#9662;", h.appendChild(I), I.onclick = function(c) {
                    (new d.Event(c)).stopPropagation();
                    disposeInternal();
                    P = !0;
                    0 < w.length ? ha(N, I, zb, null) : s(N, I, zb, null);
                    n = 8;
                }, h = b.insertCell(-1), h.style.textAlign = "right", spnShared = document.createElement("SPAN"), spnShared.className = f.lblCss, spnShared.style.display = "none", h.appendChild(spnShared), Y = new d.TextBox.Control, Y.init(new d.TextBox.Settings(h, "ceTl" + targetElement.id, aa(f.nameCss), aa(f.nameDefCss), 50, f.els.lbl.n, f.els.er.e104, aa(f.invalidColor))), qa = new d.TextBox.Control,
            qa.init(new d.TextBox.Settings(h, "ceTd" + targetElement.id, aa(f.descCss), aa(f.descDefCss), 80, f.els.lbl.d, f.els.er.e104, aa(f.invalidColor))), c = document.createElement("SPAN"), c.id = "ceA" + targetElement.id, c.className = aa(f.saveButCss), c.innerHTML = f.els.lbl.a, h.appendChild(c), c.onclick = function() {
                (6 == n || 8 == n) && ra();
                var c = za();
                0 == c.length || 1 == c.length && (!g(r(c[0])) || r(c[0]) == elementType.Flow) ? alert(f.els.er.e106) : gc("ceSave");
            });
            y.appendChild(a);
            targetElement.appendChild(y);
        }, uc = function(c, a) {
            if (g(f.els.ms.i101)) {
                var b = "ceH" + targetElement.id;
                $ = document.getElementById(b);
                g($) && $.parentNode.removeChild($);
                $ = document.createElement("DIV");
                $.id = b;
                a && ($.className = aa(f.helpCss));
                c.appendChild($);
                $.innerHTML = f.els.ms.i101;
            } else vc();
        }, vc = function() {
            var c = document.getElementById("ceH" + targetElement.id);
            g(c) && c.parentNode.removeChild(c);
            $ = null;
            f.help = !1;
        }, gc = function(c) {
            Qa = c;
            if ($a)
                switch (Qa) {
                case "ceDelete":
                    if (!g(da)) throw Error("CL31");
                    if (!g(Pb)) {
                        alert("Delete action is not defined");
                        break;
                    }
                    Ja = !0;
                    Pb(da);
                    break;
                case "ceSave":
                    if (!g(Ob)) {
                        alert("Save action is not defined");
                        break;
                    }
                    Ja = !1;
                    Ob(Pa.serialize(qb()));
                    break;
                default:
                    if (!g(Qb)) {
                        alert("Load action is not defined");
                        break;
                    }
                    Ja = !0;
                    Qb(c);
                }
            else if (kc) {
                Ja = "ceSave" != Qa;
                try {
                    eval(f.pb + "('" + elementId + "','')");
                } catch(a) {
                    throw Error("CL81");
                }
            } else
                switch (Qa) {
                case "ceDelete":
                    if (!g(da)) throw Error("CL32");
                    if (!f.pb || !f.pb.d) {
                        alert("Delete action is not defined");
                        break;
                    } else window.location = f.pb.d.replace("_ce_", da);
                    break;
                case "ceSave":
                    if (!g(pb)) throw Error("CL33");
                    if (!f.pb || !f.pb.s) {
                        alert("Save action is not defined");
                        break;
                    } else if (g(La))
                        Vb(), La.action ? La.action = f.pb.s : La.setAttribute("action",
                            f.pb.s), La.submit();
                    else {
                        c = document.createElement("FORM");
                        document.body.appendChild(c);
                        c.action ? c.action = f.pb.s : c.setAttribute("action", f.pb.s);
                        c.method ? c.method = "post" : c.setAttribute("method", "post");
                        var b = document.createElement("INPUT");
                        b.type = "hidden";
                        b.id = pb;
                        b.name = elementId;
                        Ja = !1;
                        b.value = Pa.serialize(qb());
                        c.appendChild(b);
                        c.submit();
                    }
                    break;
                default:
                    !f.pb || !f.pb.l ? alert("Load action is not defined") : window.location = f.pb.l.replace("_ce_", Qa);
                }
        }, fd = function(c) {
            if (f.help) {
                var a = z(f.els.fds, c), b = null;
                g(a) ?
                    a.d && (b = a.d) : (a = z(f.els.acs, c), g(a) && a.d ? b = a.d : (a = z(f.els.rls, c), g(a) && a.d && (b = a.d)));
                g(b) && 0 < b.length ? db(b) : bb();
            }
        }, zb = function(c) { "ceEval" == c || "ceExec" == c ? (f.isEval = "ceEval" == c, oc()) : (ua.close(), n = 1, gc(c)); }, mc = function() {
            var c = "ceC" + targetElement.id;
            if (!g(document.getElementById(c))) {
                var a = document.createElement("SPAN");
                a.id = c;
                a.className = aa(f.deleteCss);
                a.innerHTML = f.els.lbl.u;
                d.getChildrenByTagName(y, "TABLE", !0)[0].rows[0].cells[1].appendChild(a);
                a.onclick = function() { confirm(f.els.er.e105) && gc("ceDelete"); };
            }
        },
            xc = function() {
                if (g(t))
                    try {
                        var c = t.parentNode;
                        g(c) || (c = document.body);
                        c.removeChild(t);
                    } catch(a) {
                        t.style.display = "none";
                    }
                t = document.createElement("DIV");
                t.id = (new Date).getMilliseconds() * Ia + E;
                t.style.position = "absolute";
                t.style.left = "0px";
                t.style.top = "0px";
                t.style.textAlign = "right";
                t.style.width = "200px";
                c = document.createElement("A");
                c.innerHTML = "Rule.CodeEffects.com";
                c.href = "http://rule.codeeffects.com";
                c.target = "_blank";
                c.style.fontSize = "10px";
                t.appendChild(c);
                document.body.appendChild(t);
                Sc();
            }, Sc =
                function() {
                    if (Wb && g(t)) {
                        var c = pa(f.tools || f.help ? y : targetElement), a = pa(t);
                        t.style.left = c.x + c.width - a.width - 8 + "px";
                        c = c.y - a.height - 4;
                        0 > c && (c = 0);
                        t.style.top = c + "px";
                    }
                }, Wb = 0 < Lb(document.body, "ce002", "true").length, z = function(c, a) {
                    for (var b in c) if (g(c[b].v) && c[b].v == a || g(c[b].ID) && c[b].ID == a) return c[b];
                    return null;
                }, sa = function() {
                    if (!g(da)) return f.els.fds;
                    var c = [], a, b;
                    for (b in f.els.fds) a = f.els.fds[b], a.ir && a.v == da || c.push(a);
                    return c;
                }, W = function() {
                    var c = [], a, b;
                    for (b in f.els.cls)
                        a = f.els.cls[b], f.isEval && "then" ==
                            a.v || c.push(a);
                    return c;
                }, zc = function(c, a) {
                    for (var b in f.els.ops) if (f.els.ops[b].v == c && f.els.ops[b].o == a) return f.els.ops[b];
                    return null;
                }, Na = function(c, a) {
                    var b = [], d, m, k, j;
                    c.t == elementType.Function ? (m = c.rt.o, k = c.rt.l, j = g(c.rt.mds)) : c.ir ? (k = j = !1, m = operatorType.Bool) : (k = c.l, m = c.o, j = g(c.mds));
                    for (var n in f.els.ops)
                        if (d = f.els.ops[n], d.o == m && !(g(a) && d.v == a) && (k || !("isNull" == d.v || "isNotNull" == d.v))) {
                            if (m == operatorType.Numeric && j)
                                if (k) {
                                    if ("isNull" != d.v && "isNotNull" != d.v && "equal" != d.v && "notEqual" != d.v) continue;
                                } else if ("equal" != d.v && "notEqual" !=
                                    d.v) continue;
                            b.push(d);
                        }
                    return b;
                }, Ec = function() {
                    var c = [];
                    J("true", null, f.els.lbl.t, c);
                    J("false", null, f.els.lbl.f, c);
                    return c;
                }, Lc = function(c, a) {
                    var b = [], d, k = a.t == elementType.Function ? a.rt.e : a.e, j = a.t == elementType.Function ? a.rt.mds : a.mds, n;
                    for (n in f.els.fds) d = f.els.fds[n], d.o == operatorType.Enum && (!g(k) || k != d.e) || d.t == elementType.Field && (!d.ir && d.o == c) && (g(d.mds) ? g(j) && d.mds == j && b.push(d) : g(j) || b.push(d));
                    return b;
                }, hc = function(c) {
                    var a = [], b, d;
                    for (d in f.els.fds)
                        b = f.els.fds[d], b.t == elementType.Field && (!b.ir && !g(b.mds) && b.o == operatorType.Numeric && b.i && (!g(c) || b.v !=
                            c)) && a.push(b);
                    return a;
                }, cb = function(c) {
                    var a = Dc(c), b = null;
                    null != a && (b = a.Client ? eval(a.Data[0] + "()") : eval("CodeEffects.Rule." + c));
                    return b;
                }, Dc = function(c) {
                    for (var a in f.els.mds) if (f.els.mds[a].Name == c) return f.els.mds[a];
                    return null;
                }, Rc = function(c) {
                    if (g(D)) {
                        var a = document.getElementById(D);
                        g(a) && (a.className = a.className.replace(" " + f.currentBg, ""));
                    }
                    g(b) && (b.className = b.className.replace(" " + f.currentBg, ""));
                    c.setAttribute("ce207", "true");
                    b = c;
                }, la = function() {
                    if (g(b)) {
                        b.removeAttribute("ce207");
                        var c =
                            r(b);
                        if (c == elementType.Value && ca(b) == operatorType.Numeric && ga(b) != inputType.Field || c == elementType.Calculation && V(b) == calculationType.Number || (c == elementType.Function || c == elementType.Action) && ga(b) == inputType.Input && ca(b) == operatorType.Numeric) {
                            var a, d;
                            var l = b.getAttribute(S);
                            try {
                                if (g(l)) {
                                    var m = parseFloat(l);
                                    a = g(m) && "-0." != l && "0." != l;
                                } else a = !1;
                            } catch(n) {
                                a = !1;
                            }
                            a ? c != elementType.Calculation && (g(b.getAttribute("ce211")) ? d = parseInt(b.getAttribute("ce211"), 10) : (a = wa(b), g(a) && (c = z(c == elementType.Action ? f.els.acs : f.els.fds, a.getAttribute(H)), M(b) == functionType.Param ? (c = c.ps[Ua(b)], g(c.min) && (d = c.min)) : d = c.t == elementType.Function && g(c.rt.min) ?
                                c.rt.min : c.t == elementType.Field && g(c.min) ? c.min : 0)), d > parseInt(b.getAttribute(S), 10) && (b.innerHTML = "[" + d + "]", b.setAttribute(S, d))) : c == elementType.Calculation ? (b.innerHTML = "[0]", b.setAttribute(S, "0")) : (d = 0, g(b.getAttribute("ce211")) ? d = parseInt(b.getAttribute("ce211"), 10) : (a = wa(b), g(a) && (c = z(c == elementType.Action ? f.els.acs : f.els.fds, a.getAttribute(H)), c.t == elementType.Function && g(c.rt.min) ? d = c.rt.min : c.t == elementType.Field && g(c.min) && (d = c.min))), b.innerHTML = "[" + d + "]", b.setAttribute(S, d));
                            g(b.getAttribute("ce212")) && (d = parseInt(b.getAttribute("ce212"),
                                10), d < parseInt(b.getAttribute(S), 10) && (b.innerHTML = "[" + d + "]", b.setAttribute(S, d)));
                        }
                    }
                }, ac = function() {
                    var c = za(), a = !1, d;
                    for (d in c) r(c[d]) == elementType.Flow && "else" == c[d].getAttribute(H) && (a = !0);
                    if (!g(b.nextSibling) && a) return [];
                    var c = [], h;
                    for (h in f.els.fls) "if" != f.els.fls[h].v && (!a || "else" != f.els.fls[h].v) && c.push(f.els.fls[h]);
                    return c;
                }, Ba = function() {
                    var c = [];
                    switch (r(Aa(b))) {
                    case elementType.LeftBracket:
                        J(calculationType.LeftParenthesis, null, "(", c);
                        J(calculationType.Number, null, Va(operatorType.Numeric), c);
                        var a = hc(), d;
                        for (d in a)
                            J(calculationType.Field, a[d].v, a[d].n,
                                c);
                        break;
                    case elementType.Calculation:
                        d = V(b);
                        d == calculationType.None && (d = V(Aa(b)));
                        switch (d) {
                        case calculationType.Number:
                        case calculationType.Field:
                        case calculationType.RightParenthesis:
                            d = a = 0;
                            var f;
                            a: {
                                for (f = b; g(f);) {
                                    if (r(f) == elementType.RightBracket) break a;
                                    f = f.nextSibling;
                                }
                                f = null;
                            }
                            for (f = f.previousSibling; g(f) && r(f) != elementType.LeftBracket;) V(f) == calculationType.LeftParenthesis && a++, V(f) == calculationType.RightParenthesis && d++, f = f.previousSibling;
                            a > d && J(calculationType.RightParenthesis, null, ")", c);
                            J(calculationType.Addition, null, "+", c);
                            J(calculationType.Subtraction, null, "&#150;", c);
                            J(calculationType.Multiplication, null, "&#215;", c);
                            J(calculationType.Division, null, "&#247;", c);
                            break;
                        case calculationType.LeftParenthesis:
                        case calculationType.Addition:
                        case calculationType.Subtraction:
                        case calculationType.Multiplication:
                        case calculationType.Division:
                            for (a in J(calculationType.LeftParenthesis, null, "(", c), J(calculationType.Number, null, Va(operatorType.Numeric), c), d = hc(), d) J(calculationType.Field, d[a].v, d[a].n, c);
                        }
                        break;
                    default:
                        throw Error("CL80");
                    }
                    return c;
                }, $b = function(c, a) {
                    if (!g(c) || 0 == c.ps.length) return a;
                    var d = Ua(b);
                    for (0 > d && (d = 0); d < c.ps.length;) {
                        if (g(c.ps[d].f)) return c.ps[d].f;
                        d++;
                    }
                    return a;
                }, J = function(c, a, b, e) {
                    var f = new d.Menu.Item;
                    f.ID = c;
                    g(a) && (f.Type = a + E);
                    f.Name = b;
                    e.push(f);
                }, id = function(c, a) {
                    if (c ==
                        calculationType.None || a == calculationType.None) throw Error("CL90");
                    switch (c) {
                    case calculationType.Field:
                        return a == calculationType.Number || a == calculationType.Field;
                    case calculationType.Number:
                        return a == calculationType.Field || a == calculationType.Number;
                    case calculationType.LeftParenthesis:
                        return a == calculationType.LeftParenthesis;
                    case calculationType.RightParenthesis:
                        return a == calculationType.RightParenthesis;
                    default:
                        return a == calculationType.Multiplication || a == calculationType.Division || a == calculationType.Addition || a == calculationType.Subtraction;
                    }
                }, Hc = function(c, a) {
                    var b = [];
                    if (!g(c) || 0 == c.length) return b;
                    a = a.toLowerCase();
                    var d, e;
                    for (e in c) d = c[e].n || c[e].Name, d.length >= a.length && d.substr(0, a.length).toLowerCase() == a && b.push(c[e]);
                    return b;
                }, jd = function() {
                    if (!g(b)) return "i101";
                    if (8 == n) return "i126";
                    var a = Aa(b), d;
                    switch (r(a)) {
                    case elementType.Flow:
                        return "else" == a.getAttribute(H) ? "i110" : "i103";
                    case elementType.LeftParenthesis:
                        return "i103";
                    case elementType.RightParenthesis:
                        return "i111";
                    case elementType.Field:
                        return fa ? "i127" : "i104";
                    case elementType.LeftBracket:
                        return "i106";
                    case elementType.RightBracket:
                        return "i121";
                    case elementType.Calculation:
                        return "i108";
                    case elementType.Action:
                        switch (M(a)) {
                        case functionType.End:
                            return ma(a) && fa ? "i128" : "else" == ec(a, elementType.Flow).getAttribute(H) ? "i124" : "i125";
                        case functionType.Name:
                            return fa ? "i128" :
                                "i123";
                        default:
                            return "i123";
                        }
                    case elementType.Function:
                        switch (M(a)) {
                        case functionType.End:
                            return ma(a) && fa ? "i127" : "i104";
                        case functionType.Name:
                            return fa ? "i127" : "i123";
                        default:
                            return "i123";
                        }
                    case elementType.Operator:
                        if (fa) return "i129";
                        d = ca(a);
                        return d == operatorType.Numeric ? (a = wa(a), a = g(a) ? z(f.els.fds, a.getAttribute(H)) : null, g(a) && a.cal ? "i122" : "i113") : d == operatorType.String ? "i113" : d == operatorType.Date ? "i114" : d == operatorType.Time ? "i117" : "i119";
                    case elementType.Value:
                        return d = ca(a), d == operatorType.String || d == operatorType.Numeric ? g(a.getAttribute("ce207")) ? "i105" : fa ? "i131" : "i107" : d == operatorType.Date ? 3 == n ? "i109" : fa ? "i132" : "i115" :
                            d == operatorType.Time ? 4 == n ? "i116" : fa ? "i133" : "i118" : fa ? "i134" : "i120";
                    case elementType.Clause:
                        return "then" == a.getAttribute(H) ? "i110" : fa ? "i129" : "i103";
                    default:
                        return "i122";
                    }
                }, Va = function(a, b) {
                    switch (a) {
                    case operatorType.String:
                        return f.els.lbl.s;
                    case operatorType.Date:
                        return f.els.lbl.v;
                    case operatorType.Time:
                        return f.els.lbl.j;
                    case operatorType.Numeric:
                        return b ? f.els.lbl.e : f.els.lbl.m;
                    case operatorType.Bool:
                        return f.els.lbl.b;
                    case operatorType.Enum:
                        return f.els.lbl.e;
                    default:
                        throw Error("CL45");
                    }
                }, tb = function(a, b) {
                    return a.getAttribute && g(a.getAttribute("ce204")) && (r(a) == elementType.Function || r(a) ==
                        elementType.Action) && M(a) == b ? a : g(a.previousSibling) ? tb(a.previousSibling, b) : null;
                }, Xb = function(a, b) { return a.getAttribute && g(a.getAttribute("ce204")) && (r(a) == elementType.Function || r(a) == elementType.Action) && M(a) == b ? a : g(a.nextSibling) ? Xb(a.nextSibling, b) : null; }, ec = function(a, b) { return a.getAttribute && g(a.getAttribute("ce202")) && r(a) == b ? a : g(a.previousSibling) ? ec(a.previousSibling, b) : null; }, wa = function(a) {
                    return !g(a) ? null : g(a.getAttribute) && g(a.getAttribute("ce202")) && (r(a) == elementType.Field || elementType.Function && M(a) == functionType.Name) ? a : g(a.previousSibling) ?
                        wa(a.previousSibling) : null;
                }, xb = function(a, b) { return !g(a) ? null : g(a.getAttribute) && g(a.getAttribute("ce202")) && r(a) == b ? a : g(a.nextSibling) ? xb(a.nextSibling, b) : null; }, cc = function(a) { return a.getAttribute && g(a.getAttribute("ce202")) && r(a) != elementType.HtmlTag ? a : g(a.nextSibling) ? cc(a.nextSibling) : null; }, Aa = function(a) { return wb(a) ? a : g(a.previousSibling) ? Aa(a.previousSibling) : null; }, Ya = function(a) { return wb(a) ? a : g(a.nextSibling) ? Ya(a.nextSibling) : null; }, Xa = function(a, b) {
                    if (!g(a)) return null;
                    var d = M(a);
                    return d == functionType.End ?
                        null : d == functionType.Param && ca(a) == b ? a : g(a.nextSibling) ? Xa(a.nextSibling, b) : null;
                }, nc = function() {
                    N = [];
                    var a = new d.Menu.Item;
                    a.ID = "ceEval";
                    a.Name = f.els.lbl.y;
                    N.push(a);
                    g(f.els.lbl.x) && (a = new d.Menu.Item, a.ID = "ceExec", a.Name = f.els.lbl.x, N.push(a));
                    for (var b in f.els.rls) a = new d.Menu.Item, a.ID = f.els.rls[b].v || f.els.rls[b].ID, a.Name = f.els.rls[b].n || f.els.rls[b].Name, N.push(a);
                }, Ca = function(a, d) {
                    if (!d) {
                        var e = tb(a, functionType.Name);
                        D = e.id;
                        b = x(e);
                    }
                    b = b.nextSibling;
                }, x = function(a) {
                    if (g(D)) {
                        var d = document.getElementById(D);
                        g(d) && (d.className =
                            d.className.replace(" " + f.currentBg, ""));
                    }
                    g(b) && (b.className = b.className.replace(" " + f.currentBg, "").replace(" " + f.highlightBg, ""));
                    -1 == a.className.indexOf(f.currentBg) && (a.className = a.className + " " + f.currentBg);
                    return a;
                }, ma = function(a) { return (r(a) == elementType.Function || r(a) == elementType.Action) && (M(a) == functionType.Name || M(a) == functionType.End) ? (a = ba(a), !g(a) || !g(a.ps) ? !0 : 0 == a.ps.length) : !1; }, wb = function(a) { return a.getAttribute && g(a.getAttribute("ce202")) ? (a = r(a), a != elementType.Tab && a != elementType.NewLine && a != elementType.HtmlTag) : !1; }, va = function(a, b, d, f) {
                    return a == elementType.Value &&
                        (b == operatorType.String || b == operatorType.Numeric) || a == elementType.Calculation && d == calculationType.Number || (a == elementType.Function || a == elementType.Action) && f == inputType.Input && (b == operatorType.String || b == operatorType.Numeric);
                }, oa = function(a) { return 31 < a && 40 > a || 41 < a && 60 > a || 61 == a || 63 < a && 91 > a || 96 < a && 123 > a || 222 < a; }, Bc = function() {
                    var a = za(), b;
                    for (b in a)
                        switch (r(a[b])) {
                        case elementType.Clause:
                        case elementType.Function:
                        case elementType.Field:
                        case elementType.Operator:
                        case elementType.Value:
                        case elementType.Action:
                        case elementType.LeftParenthesis:
                        case elementType.RightParenthesis:
                        case elementType.Calculation:
                            return !0;
                        }
                    return !1;
                }, pc = function() {
                    try {
                        window.clearInterval(Hb);
                    } catch(a) {
                    }
                    Hb = null;
                },
            Tc = function() {
                g(B) && Ra();
                if (va(r(b), ca(b), V(b), ga(b)) && g(b.getAttribute("ce207"))) {
                    b.className = b.className.replace(" " + f.currentBg, "");
                    if (g(b) && g(A)) {
                        var a = d.Client.browser == d.Client.type.Firefox ? 3 : 2, j = r(b), n = ca(b);
                        if (j == elementType.Value) n == operatorType.String ? a += ib : n == operatorType.Numeric && (a += Za);
                        else if (j == elementType.Calculation && V(b) == calculationType.Number) a = Za + 2;
                        else if ((j == elementType.Function || j == elementType.Action) && ga(b) == inputType.Input) n == operatorType.String ? a += ib : n == operatorType.Numeric && (a += Za);
                        j = pa(b);
                        A.style.left = j.x + j.width - a + "px";
                        a = 0;
                        if (d.Client.browser == d.Client.type.Firefox || d.Client.browser ==
                            d.Client.type.IE && 8 > d.Client.version && Rb) a = -2;
                        else if (d.Client.browser == d.Client.type.Chrome || jb) a = -1;
                        A.style.top = j.y + j.height / 2 - 9 + a + "px";
                    }
                    try {
                        B = window.setInterval(kd, 320);
                    } catch(l) {
                        throw Ra(), Error("CL94");
                    }
                }
            }, kd = function() {
                try {
                    window.clearInterval(B);
                } catch(a) {
                    throw Error("CL96");
                }
                B = null;
                A.style.display = "none" == A.style.display ? "" : "none";
                Tc();
            }, Ra = function() {
                try {
                    window.clearInterval(B);
                } catch(a) {
                    throw Error("CL97");
                }
                B = null;
                g(A) && (A.style.display = "none");
            }, Q = function() {
                Ra();
                Ub();
                g(A) && g(b) && (fa || bb(), Tc(),
                3 == n ? T.position() : 4 == n ? ia.position() : (6 == n || 8 == n) && ra());
            }, Z = function() {
                if (g(b.nextSibling)) {
                    if (f.right) {
                        var a = r(b.nextSibling);
                        return a != elementType.NewLine && a != elementType.Tab;
                    }
                    return !1;
                }
                return !0;
            }, Fb = function() {
                if (g(b.nextSibling))
                    for (b = b.nextSibling; g(b.nextSibling) && !wb(b.nextSibling);) {
                        var a = b.nextSibling;
                        targetElement.removeChild(b);
                        b = a;
                    }
                Oa();
            }, qc = function() {
                var a = ya ? 1 : 2, b = document.createElement("SPAN");
                b.id = "ceQ" + targetElement.id;
                targetElement.appendChild(b);
                b.innerHTML = '"';
                ib = pa(b).width + a;
                ya && Rb && (ib += 2);
                b.innerHTML = "]";
                Za = pa(b).width + a;
                ya && Rb && (Za +=
                    1);
                targetElement.removeChild(b);
            }, Gb = function() {
                if (!g(A)) {
                    A = document.createElement("DIV");
                    A.id = "ceR" + targetElement.id;
                    A.className = f.cursorOuter;
                    A.style.position = "absolute";
                    A.style.display = "none";
                    A.style.left = "0px";
                    A.style.top = "0px";
                    A.style.textAlign = "center";
                    A.style.width = "3px";
                    A.style.paddingLeft = "2px";
                    var a = document.createElement("DIV");
                    a.id = "ceD" + targetElement.id;
                    a.className = f.cursorInner;
                    a.style.height = "18px";
                    a.style.width = "1px";
                    A.appendChild(a);
                    document.body.appendChild(A);
                }
            }, rc = function() {
                if (ya && 8 < d.Client.version && window.Modernizr &&
                    3 > Kb) Kb++;
                else if (!b || !ya || !(8 > d.Client.version && va(r(b), ca(b), V(b), ga(b)) && g(b.getAttribute("ce207")))) ka = 0, 1 != n && 2 != n && Q(), Sc();
            }, ed = function() {
                if (G) {
                    (6 == n || 8 == n) && ra();
                    var a = r(b);
                    a != elementType.NewLine && a != elementType.Tab ? Sa(!1) : Q();
                }
            }, ra = function() {
                Jb = 0;
                w = E;
                C = [];
                ua.close();
                n = 0;
            }, wc = function() {
                targetElement.innerHTML = E;
                var a = document.createElement("SPAN");
                a.className = f.emptyColor;
                a.style.marginTop = a.style.marginLeft = a.style.marginRight = a.style.marginBottom = "0px";
                a.style.paddingBottom = "2px";
                a.style.display = "inline-block";
                a.style.whiteSpace =
                    "nowrap";
                a.style.cursor = "default";
                a.innerHTML = f.els.lbl.g;
                targetElement.appendChild(a);
                b = null;
            }, yc = function() { g(targetElement) && (targetElement.innerHTML = E, targetElement.style.color = ""); }, yb = function(a) {
                if (d.getScrollHeight() > a)
                    try {
                        window.scroll(d.getScrollWidth(), a);
                    } catch(b) {
                    }
            }, dc = function(a, b) {
                var e = d.getWindowDimensions().height, f = d.getScrollHeight();
                if (e + f < a + b)
                    try {
                        window.scroll(d.getScrollWidth(), f + (a + b - (e + f)));
                    } catch(g) {
                    }
            }, Ma = function(a) { return String(a).replace(/\\/g, "\\\\").replace(/'/g, "'").replace(/"/g, "&quot;"); }, Fa = function(a) {
                return String(a).replace(/&#92;/g,
                    "\\").replace(/&#39;/g, "'").replace(/&quot;/g, '"');
            }, Ta = function (a) {
                return a.replace("+", "$");
            }, xa = function (a, b) {
                g(b) && 0 < b.length && (a.className = aa(b));
            }, sb = function (a) {
                return "true" == a ? f.els.lbl.t : f.els.lbl.f;
            }, aa = function (a) {
                return d.defined(a) ? a : "";
            }, bb = function () {
                f.help && db(f.els.ms[jd()]);
            }, dd = function () {
                X = !1;
            }, fb = function (a) {
                return g(a) && a.getAttribute && "if" == a.getAttribute(H);
            }, za = function () {
                return d.getChildrenByTagName(targetElement, "SPAN", !1);
            }, r = function (a) {
                return parseInt(a.getAttribute("ce202"), 10);
            }, ca = function (a) {
                return parseInt(a.getAttribute("ce209"), 10);
            }, V = function(a) { return parseInt(a.getAttribute("ce203"), 10); }, M = function(a) { return parseInt(a.getAttribute("ce204"), 10); }, ga = function(a) { return parseInt(a.getAttribute("ce205"), 10); }, Vc = function(a) {
                Gb();
                return bd(a);
            }, Xc = function(a) {
                Gb();
                var d;
                if (1 == n || 2 == n) d = !0;
                else {
                    a = a.keyCode;
                    if (16 != a) {
                        var f;
                        8 != n && (46 == a && g(b.nextSibling) && (b = cc(b.nextSibling)), f = r(b), d = ca(b));
                        switch (a) {
                        case 27:
                            w = E;
                            if (8 == n) {
                                ra();
                                break;
                            }
                            6 == n ? ra() : 3 == n ? (T.hide(), n = 0) : 4 == n && (ia.hide(), n = 0);
                            break;
                        case 127:
                            w = E;
                            if (8 == n) {
                                ra();
                                break;
                            }
                            6 ==
                                n && ra();
                            if (3 == n) T.hide(), n = 0;
                            else if (4 == n) ia.hide(), n = 0;
                            else if (va(f, d, V(b), ga(b)) && g(b.getAttribute("ce207"))) break;
                            else g(b.nextSibling) ? r(b.nextSibling) == elementType.HtmlTag ? Fb() : f == elementType.NewLine ? (ja(b), ja(b), g(b.nextSibling) && (g(b.nextSibling) && r(b.nextSibling) == elementType.Tab && Fb(), b = x(g(b.nextSibling) ? b.nextSibling : b))) : fb(b) ? (b = b.nextSibling, Oa()) : (Oa(), g(b.nextSibling) && (r(b.nextSibling) == elementType.HtmlTag && Fb(), b = x(g(b.nextSibling) ? b.nextSibling : b))) : f == elementType.NewLine ? (ja(b), ja(b)) : fb(b) || Oa(), ma(b) && Ca(b);
                            break;
                        case 8:
                            w = E;
                            if (8 == n) {
                                ra();
                                break;
                            }
                            6 == n && ra();
                            3 == n ? (T.hide(), n = 0) : 4 == n ? (ia.hide(), n = 0) : (va(f, d, V(b), ga(b)) ? g(b.getAttribute("ce207")) ? (f = Ka(b), 2 < f.length ? (d = d == operatorType.String ? '"' : "]", Ka(b, f.substr(0, f.length - 2) + d), b.setAttribute(S, f.substr(1, f.length - 3)), Q()) : (la(), Q(), b = x(b))) : Qc() : g(b.previousSibling) && (!fb(b) && !fb(b.previousSibling)) && Qc(), ma(b) && Ca(b));
                        }
                    }
                    d = !1;
                }
                return d;
            }, Wc = function(a) {
                Gb();
                return cd(a);
            }, Uc = function(a) {
                Gb();
                var p = function(a) { ma(a) ? Ca(a) : b = x(a); }, t = function() {
                    var a = Xb(b, functionType.End);
                    g(a) && (b = x(a), Oa());
                }, l = function(a,
                    c) {
                    var d = ca(a), j = z(f.els.fds, c), k, l, m;
                    g(j) ? (j = j.t == elementType.Function ? j.rt : j, k = j.l, l = j.o, m = j.e, j = j.mds) : (k = !0, l = d, m = j = null);
                    var n = [], p, q;
                    for (q in f.els.fds) if (p = f.els.fds[q], !p.ir || !(g(da) && p.v == da || d != operatorType.Bool)) p.v != c && (p.t == elementType.Function ? p.rt.o == d && (p.rt.l == k && (l != operatorType.Enum || m == p.rt.e) && p.mds == j) && n.push(p) : p.o == d && (p.l == k && (l != operatorType.Enum || m == p.e) && p.mds == j) && n.push(p));
                    0 < n.length ? (P = !0, s(n, a, v, null)) : (fa = !1, d = z(f.els.fds, c), g(d) && (d.t == elementType.Function ? 0 < d.ps.length ? (b = x(a), Da(d)) : eb(d) : s(Na(d), a, Ga, null)));
                }, m = function(a,
                    c) {
                    var d = [], e, g;
                    for (g in f.els.acs) e = f.els.acs[g], e.v != c && d.push(e);
                    1 < d.length || 1 == d.length && d[0].v != c ? (P = !0, s(d, a, w, null)) : (fa = !1, d = ac(), 0 < d.length && s(d, b, bc, null));
                }, v = function(a) {
                    r(b) == elementType.Function ? t(a) : L = !0;
                    var c = z(f.els.fds, a);
                    c.t == elementType.Function ? ub(c.t, a) : (hb(c, null), Z() && s(Na(c), b, Ga, null));
                }, w = function(a) {
                    t(a);
                    ub(z(f.els.acs, a).t, a);
                };
                fa = !1;
                var u = a.target;
                g(A) && (A.style.display = "none");
                L = P = !1;
                if (g(d.getParentById(u, targetElement.id))) {
                    Ra();
                    la();
                    ka = 0;
                    if (6 == n || 8 == n) ua.close(), n = Bc() ? 0 : 2;
                    if (4 == n) ia.hide(), n = 0;
                    else if (3 ==
                        n) T.hide(), n = 0;
                    else if (2 == n || 1 == n && !g(b)) yc(), O(elementType.Flow, null, "if", f.isEval ? f.evalIf : f.execIf, null, null, null, null), b = x(b), s(sa(), b, ta, elementType.LeftParenthesis);
                    else {
                        var B = !0;
                        if (g(u.getAttribute("ce202"))) va(r(u), ca(u), V(u), ga(u)) && ga(u) != inputType.Field ? Rc(u) : p(u);
                        else {
                            var B = !1, u = za(), D, E = !1, K = d.Client.browser == d.Client.type.IE && 9 > d.Client.version ? d.getScrollHeight() : 0, G;
                            for (G in u) {
                                if (!g(u[G].nextSibling)) {
                                    p(u[G]);
                                    E = !0;
                                    break;
                                }
                                D = pa(r(u[G].nextSibling) == elementType.HtmlTag ? u[G].nextSibling.nextSibling : u[G].nextSibling);
                                if (D.y >
                                    a.offsetY + K) {
                                    p(u[G]);
                                    E = !0;
                                    break;
                                }
                            }
                            !E && 0 < u.length && p(u[u.length - 1]);
                        }
                        fa = f.clicks && g(b) && B && !g(b.getAttribute("ce207"));
                        Q();
                        n = 0;
                        if (fa) {
                            a = b.getAttribute(H);
                            switch (r(b)) {
                            case elementType.Flow:
                                "else" == a ? s(f.els.acs, b, w, null) : s(sa(), b, ta, elementType.LeftParenthesis);
                                break;
                            case elementType.Function:
                                switch (M(b)) {
                                case functionType.Param:
                                    var y = ba(b);
                                    L = P = !0;
                                    Da(y);
                                    break;
                                case functionType.Name:
                                    l(b, a);
                                    break;
                                case functionType.End:
                                    ma(b) && l(b.previousSibling, a);
                                }
                                break;
                            case elementType.Field:
                                l(b, a);
                                break;
                            case elementType.Action:
                                switch (M(b)) {
                                case functionType.Param:
                                    y = ba(b);
                                    L = P = !0;
                                    Da(y);
                                    break;
                                case functionType.Name:
                                    m(b, a);
                                    break;
                                case functionType.End:
                                    ma(b) && m(b.previousSibling, a);
                                }
                                break;
                            case elementType.Calculation:
                                var C = [];
                                switch (V(b)) {
                                case calculationType.Field:
                                    J(calculationType.Number, null, Va(operatorType.Numeric), C);
                                    l = hc(a);
                                    for (y in l) J(calculationType.Field, l[y].v, l[y].n, C);
                                    L = P = !0;
                                    s(C, b, na, null);
                                    break;
                                case calculationType.Addition:
                                    J(calculationType.Subtraction, null, "&#150;", C);
                                    J(calculationType.Multiplication, null, "&#215;", C);
                                    J(calculationType.Division, null, "&#247;", C);
                                    L = P = !0;
                                    s(C, b, na, null);
                                    break;
                                case calculationType.Subtraction:
                                    J(calculationType.Addition, null, "+", C);
                                    J(calculationType.Multiplication, null, "&#215;", C);
                                    J(calculationType.Division, null, "&#247;", C);
                                    L = P = !0;
                                    s(C, b, na, null);
                                    break;
                                case calculationType.Multiplication:
                                    J(calculationType.Addition,
                                        null, "+", C);
                                    J(calculationType.Subtraction, null, "&#150;", C);
                                    J(calculationType.Division, null, "&#247;", C);
                                    L = P = !0;
                                    s(C, b, na, null);
                                    break;
                                case calculationType.Division:
                                    J(calculationType.Addition, null, "+", C), J(calculationType.Subtraction, null, "&#150;", C), J(calculationType.Multiplication, null, "&#215;", C), L = P = !0, s(C, b, na, null);
                                }
                                break;
                            case elementType.Operator:
                                y = wa(b);
                                g(y) && (y = z(f.els.fds, y.getAttribute(H)), g(y) && (y = Na(y, a), g(y) && 0 < y.length ? (L = P = !0, s(y, b, Ga, null)) : (fa = !1, "isNull" == a || "isNotNull" == a ? s(W(), b, U, elementType.RightParenthesis) : gb(Aa(b)))));
                                break;
                            case elementType.Clause:
                                if ("then" == a) s(f.els.acs, b, Ha, null);
                                else {
                                    y =
                                        [];
                                    for (C in f.els.cls) l = f.els.cls[C], "then" != l.v && l.v != a && y.push(l);
                                    g(y) && 0 < y.length ? (L = P = !0, s(y, b, U, null)) : s(sa(), b, ta, elementType.LeftParenthesis);
                                }
                                break;
                            case elementType.Value:
                                L = P = !0, gb(Aa(b));
                            }
                            bb();
                        }
                    }
                } else 8 == n ? u.id != I.id && (ua.close(), n = 1) : (y = T.getId(), (3 != n || null == y || !g(d.getParentById(u, y))) && disposeInternal());
            }, db = function(a) { g($) && ($.innerHTML = a); };
    };